!function (e, t) { "object" == typeof exports && "undefined" != typeof module ? t(exports) : "function" == typeof define && define.amd ? define(["exports"], t) : t((e = "undefined" != typeof globalThis ? globalThis : e || self).DUSKY = {}) }(this, (function (e) { "use strict"; var t, n = function () { return n = Object.assign || function (e) { for (var t, n = 1, r = arguments.length; n < r; n++)for (var o in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, o) && (e[o] = t[o]); return e }, n.apply(this, arguments) }; function r(e, t, n, r) { return new (n || (n = Promise))((function (o, a) { function i(e) { try { c(r.next(e)) } catch (e) { a(e) } } function u(e) { try { c(r.throw(e)) } catch (e) { a(e) } } function c(e) { var t; e.done ? o(e.value) : (t = e.value, t instanceof n ? t : new n((function (e) { e(t) }))).then(i, u) } c((r = r.apply(e, t || [])).next()) })) } function o(e, t) { var n, r, o, a, i = { label: 0, sent: function () { if (1 & o[0]) throw o[1]; return o[1] }, trys: [], ops: [] }; return a = { next: u(0), throw: u(1), return: u(2) }, "function" == typeof Symbol && (a[Symbol.iterator] = function () { return this }), a; function u(a) { return function (u) { return function (a) { if (n) throw new TypeError("Generator is already executing."); for (; i;)try { if (n = 1, r && (o = 2 & a[0] ? r.return : a[0] ? r.throw || ((o = r.return) && o.call(r), 0) : r.next) && !(o = o.call(r, a[1])).done) return o; switch (r = 0, o && (a = [2 & a[0], o.value]), a[0]) { case 0: case 1: o = a; break; case 4: return i.label++, { value: a[1], done: !1 }; case 5: i.label++, r = a[1], a = [0]; continue; case 7: a = i.ops.pop(), i.trys.pop(); continue; default: if (!(o = i.trys, (o = o.length > 0 && o[o.length - 1]) || 6 !== a[0] && 2 !== a[0])) { i = 0; continue } if (3 === a[0] && (!o || a[1] > o[0] && a[1] < o[3])) { i.label = a[1]; break } if (6 === a[0] && i.label < o[1]) { i.label = o[1], o = a; break } if (o && i.label < o[2]) { i.label = o[2], i.ops.push(a); break } o[2] && i.ops.pop(), i.trys.pop(); continue }a = t.call(e, i) } catch (e) { a = [6, e], r = 0 } finally { n = o = 0 } if (5 & a[0]) throw a[1]; return { value: a[0] ? a[1] : void 0, done: !0 } }([a, u]) } } } function a(e) { var t = "function" == typeof Symbol && Symbol.iterator, n = t && e[t], r = 0; if (n) return n.call(e); if (e && "number" == typeof e.length) return { next: function () { return e && r >= e.length && (e = void 0), { value: e && e[r++], done: !e } } }; throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.") } function i(e, t) { var n = "function" == typeof Symbol && e[Symbol.iterator]; if (!n) return e; var r, o, a = n.call(e), i = []; try { for (; (void 0 === t || t-- > 0) && !(r = a.next()).done;)i.push(r.value) } catch (e) { o = { error: e } } finally { try { r && !r.done && (n = a.return) && n.call(a) } finally { if (o) throw o.error } } return i } function u(e, t, n) { if (n || 2 === arguments.length) for (var r, o = 0, a = t.length; o < a; o++)!r && o in t || (r || (r = Array.prototype.slice.call(t, 0, o)), r[o] = t[o]); return e.concat(r || Array.prototype.slice.call(t)) } !function (e) { e.UI_GET_DATA = "ui-get-data", e.UI_SUBSCRIBE_TO_CHANGES = "ui-subscribe-to-changes", e.UI_UNSUBSCRIBE_FROM_CHANGES = "ui-unsubscribe-from-changes", e.UI_CHANGE_SETTINGS = "ui-change-settings", e.UI_SET_THEME = "ui-set-theme", e.UI_SET_SHORTCUT = "ui-set-shortcut", e.UI_TOGGLE_ACTIVE_TAB = "ui-toggle-active-tab", e.UI_MARK_NEWS_AS_READ = "ui-mark-news-as-read", e.UI_MARK_NEWS_AS_DISPLAYED = "ui-mark-news-as-displayed", e.UI_LOAD_CONFIG = "ui-load-config", e.UI_APPLY_DEV_DYNAMIC_THEME_FIXES = "ui-apply-dev-dynamic-theme-fixes", e.UI_RESET_DEV_DYNAMIC_THEME_FIXES = "ui-reset-dev-dynamic-theme-fixes", e.UI_APPLY_DEV_INVERSION_FIXES = "ui-apply-dev-inversion-fixes", e.UI_RESET_DEV_INVERSION_FIXES = "ui-reset-dev-inversion-fixes", e.UI_APPLY_DEV_STATIC_THEMES = "ui-apply-dev-static-themes", e.UI_RESET_DEV_STATIC_THEMES = "ui-reset-dev-static-themes", e.UI_SAVE_FILE = "ui-save-file", e.UI_REQUEST_EXPORT_CSS = "ui-request-export-css", e.UI_COLOR_SCHEME_CHANGE = "ui-color-scheme-change", e.BG_CHANGES = "bg-changes", e.BG_ADD_CSS_FILTER = "bg-add-css-filter", e.BG_ADD_STATIC_THEME = "bg-add-static-theme", e.BG_ADD_SVG_FILTER = "bg-add-svg-filter", e.BG_ADD_DYNAMIC_THEME = "bg-add-dynamic-theme", e.BG_EXPORT_CSS = "bg-export-css", e.BG_UNSUPPORTED_SENDER = "bg-unsupported-sender", e.BG_CLEAN_UP = "bg-clean-up", e.BG_RELOAD = "bg-reload", e.BG_FETCH_RESPONSE = "bg-fetch-response", e.BG_UI_UPDATE = "bg-ui-update", e.BG_CSS_UPDATE = "bg-css-update", e.CS_COLOR_SCHEME_CHANGE = "cs-color-scheme-change", e.CS_FRAME_CONNECT = "cs-frame-connect", e.CS_FRAME_FORGET = "cs-frame-forget", e.CS_FRAME_FREEZE = "cs-frame-freeze", e.CS_FRAME_RESUME = "cs-frame-resume", e.CS_EXPORT_CSS_RESPONSE = "cs-export-css-response", e.CS_FETCH = "cs-fetch", e.CS_DARK_THEME_DETECTED = "cs-dark-theme-detected", e.CS_DARK_THEME_NOT_DETECTED = "cs-dark-theme-not-detected", e.CS_LOG = "cs-log" }(t || (t = {})); var c = "undefined" != typeof navigator, s = c ? navigator.userAgentData && Array.isArray(navigator.userAgentData.brands) ? navigator.userAgentData.brands.map((function (e) { return "".concat(e.brand.toLowerCase(), " ").concat(e.version) })).join(" ") : navigator.userAgent.toLowerCase() : "some useragent", l = c ? navigator.userAgentData && "string" == typeof navigator.userAgentData.platform ? navigator.userAgentData.platform.toLowerCase() : navigator.platform.toLowerCase() : "some platform", d = s.includes("chrome") || s.includes("chromium"), f = s.includes("thunderbird"), h = s.includes("firefox") || s.includes("librewolf") || f; s.includes("vivaldi"), s.includes("yabrowser"), s.includes("opr") || s.includes("opera"), s.includes("edg"); var p = s.includes("safari") && !d, v = l.startsWith("win"), m = l.startsWith("mac"); c && navigator.userAgentData ? navigator.userAgentData.mobile : s.includes("mobile"); var g, y = "function" == typeof ShadowRoot, b = "function" == typeof MediaQueryList && "function" == typeof MediaQueryList.prototype.addEventListener; (g = s.match(/chrom(?:e|ium)(?:\/| )([^ ]+)/)) && g[1] && g[1], function () { var e = s.match(/(?:firefox|librewolf)(?:\/| )([^ ]+)/); e && e[1] && e[1] }(); var k = function () { try { return document.querySelector(":defined"), !0 } catch (e) { return !1 } }(), S = function () { if ("undefined" == typeof document) return !1; var e = document.createElement("div"); return e.setAttribute("style", "color-scheme: dark"), e.style && "dark" === e.style.colorScheme }(); function w(e, t, n) { return r(this, void 0, void 0, (function () { var r; return o(this, (function (o) { switch (o.label) { case 0: return [4, fetch(e, { cache: "force-cache", credentials: "omit", referrer: n })]; case 1: if (r = o.sent(), h && "text/css" === t && e.startsWith("moz-extension://") && e.endsWith(".css")) return [2, r]; if (t && !r.headers.get("Content-Type").startsWith(t)) throw new Error("Mime type mismatch when loading ".concat(e)); if (!r.ok) throw new Error("Unable to load ".concat(e, " ").concat(r.status, " ").concat(r.statusText)); return [2, r] } })) })) } function E(e, t) { return r(this, void 0, void 0, (function () { return o(this, (function (n) { switch (n.label) { case 0: return [4, w(e, t)]; case 1: return [4, C(n.sent())]; case 2: return [2, n.sent()] } })) })) } function C(e) { return r(this, void 0, void 0, (function () { var t; return o(this, (function (n) { switch (n.label) { case 0: return [4, e.blob()]; case 1: return t = n.sent(), [4, new Promise((function (e) { var n = new FileReader; n.onloadend = function () { return e(n.result) }, n.readAsDataURL(t) }))]; case 2: return [2, n.sent()] } })) })) } var x = function (e) { return r(void 0, void 0, void 0, (function () { return o(this, (function (e) { return [2, ""] })) })) }, T = x; function _(e) { return r(this, void 0, void 0, (function () { return o(this, (function (t) { switch (t.label) { case 0: return [4, T(e)]; case 1: return [2, t.sent()] } })) })) } window.chrome || (window.chrome = {}), chrome.runtime || (chrome.runtime = {}); var V, R, A = new Set; function M() { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; return r(this, void 0, void 0, (function () { var n, r, a, i, u, c, s; return o(this, (function (o) { switch (o.label) { case 0: if (!e[0] || e[0].type !== t.CS_FETCH) return [3, 8]; n = e[0].id, o.label = 1; case 1: return o.trys.push([1, 7, , 8]), r = e[0].data, a = r.url, i = r.responseType, [4, _(a)]; case 2: return u = o.sent(), "data-url" !== i ? [3, 4] : [4, C(u)]; case 3: return c = o.sent(), [3, 6]; case 4: return [4, ""]; case 5: c = o.sent(), o.label = 6; case 6: return A.forEach((function (e) { return e({ type: t.BG_FETCH_RESPONSE, data: c, error: null, id: n }) })), [3, 8]; case 7: return s = o.sent(), console.error(s), A.forEach((function (e) { return e({ type: t.BG_FETCH_RESPONSE, data: null, error: s, id: n }) })), [3, 8]; case 8: return [2] } })) })) } function L(e) { A.add(e) } if ("function" == typeof chrome.runtime.sendMessage) { var O = chrome.runtime.sendMessage; chrome.runtime.sendMessage = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; M.apply(void 0, u([], i(e), !1)), O.apply(chrome.runtime, e) } } else chrome.runtime.sendMessage = M; if (chrome.runtime.onMessage || (chrome.runtime.onMessage = {}), "function" == typeof chrome.runtime.onMessage.addListener) { var P = chrome.runtime.onMessage.addListener; chrome.runtime.onMessage.addListener = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; L(e[0]), P.apply(chrome.runtime.onMessage, e) } } else chrome.runtime.onMessage.addListener = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return L(e[0]) }; !function (e) { e.cssFilter = "cssFilter", e.svgFilter = "svgFilter", e.staticTheme = "staticTheme", e.dynamicTheme = "dynamicTheme" }(V || (V = {})), function (e) { e.NONE = "", e.TIME = "time", e.SYSTEM = "system", e.LOCATION = "location" }(R || (R = {})); var D = { background: "#181a1b", text: "#e8e6e3" }, I = { background: "#dcdad7", text: "#181a1b" }, N = { mode: 1, brightness: 100, contrast: 100, grayscale: 0, sepia: 0, useFont: !1, fontFamily: m ? "Helvetica Neue" : v ? "Segoe UI" : "Open Sans", textStroke: 0, engine: V.dynamicTheme, stylesheet: "", darkSchemeBackgroundColor: D.background, darkSchemeTextColor: D.text, lightSchemeBackgroundColor: I.background, lightSchemeTextColor: I.text, scrollbarColor: m ? "" : "auto", selectionColor: "auto", styleSystemControls: !S, lightColorScheme: "Default", darkColorScheme: "Default", immediateModify: !1, excludes: ".dusky-ignore" }; function F(e, t) { var n, r; if (function (e) { return null != e.length }(e)) for (var o = 0, i = e.length; o < i; o++)t(e[o]); else try { for (var u = a(e), c = u.next(); !c.done; c = u.next()) { t(c.value) } } catch (e) { n = { error: e } } finally { try { c && !c.done && (r = u.return) && r.call(u) } finally { if (n) throw n.error } } } function j(e, t) { F(t, (function (t) { return e.push(t) })) } function B(e) { var t, n = !1, r = null; return Object.assign((function () { for (var o = [], a = 0; a < arguments.length; a++)o[a] = arguments[a]; t = o, r ? n = !0 : (e.apply(void 0, u([], i(t), !1)), r = requestAnimationFrame((function () { r = null, n && (e.apply(void 0, u([], i(t), !1)), n = !1) }))) }), { cancel: function () { cancelAnimationFrame(r), n = !1, r = null } }) } function q(e) { var t = 0; return e.seconds && (t += 1e3 * e.seconds), e.minutes && (t += 60 * e.minutes * 1e3), e.hours && (t += 60 * e.hours * 60 * 1e3), e.days && (t += 24 * e.days * 60 * 60 * 1e3), t } function U(e) { e && e.parentNode && e.parentNode.removeChild(e) } function W(e, t, n) { void 0 === n && (n = Function.prototype); var r = q({ seconds: 2 }), o = q({ seconds: 10 }), a = e.previousSibling, i = e.parentNode; if (!i) throw new Error("Unable to watch for node position: parent element not found"); if ("prev-sibling" === t && !a) throw new Error("Unable to watch for node position: there is no previous sibling"); var u = 0, c = null, s = null, l = B((function () { if (!s) { u++; var f = Date.now(); if (null == c) c = f; else if (u >= 10) { if (f - c < o) return void (s = setTimeout((function () { c = null, u = 0, s = null, l() }), r)); c = f, u = 1 } if ("parent" === t && a && a.parentNode !== i) h(); else { if ("prev-sibling" === t) { if (null == a.parentNode) return void h(); a.parentNode !== i && p(a.parentNode) } i.insertBefore(e, a ? a.nextSibling : i.firstChild), d.takeRecords(), n && n() } } })), d = new MutationObserver((function () { ("parent" === t && e.parentNode !== i || "prev-sibling" === t && e.previousSibling !== a) && l() })), f = function () { d.observe(i, { childList: !0 }) }, h = function () { clearTimeout(s), d.disconnect(), l.cancel() }, p = function (e) { i = e, h(), f() }; return f(), { run: f, stop: h, skip: function () { d.takeRecords() } } } function G(e, t) { if (null != e) for (var n = document.createTreeWalker(e, NodeFilter.SHOW_ELEMENT, { acceptNode: function (e) { return null == e.shadowRoot ? NodeFilter.FILTER_SKIP : NodeFilter.FILTER_ACCEPT } }), r = e.shadowRoot ? n.currentNode : n.nextNode(); null != r; r = n.nextNode())r.classList.contains("surfingkeys_hints_host") || (t(r), G(r.shadowRoot, t)) } R.NONE; var H = function () { return "complete" === document.readyState || "interactive" === document.readyState }; var $ = new Set; function z(e) { H() ? e() : $.add(e) } function Q(e) { $.delete(e) } function K() { return "complete" === document.readyState } var Y = new Set; function X(e) { K() ? e() : Y.add(e) } if (!H()) { var Z = function () { H() && ($.forEach((function (e) { return e() })), $.clear(), K() && (document.removeEventListener("readystatechange", Z), Y.forEach((function (e) { return e() })), Y.clear())) }; document.addEventListener("readystatechange", Z) } var J = 1e3; var ee, te = new Map, ne = new WeakMap; function re(e, t) { var n, r, o; if (te.has(e)) n = te.get(e), r = ne.get(n); else { var a = !1, i = !1; n = new MutationObserver((function (t) { if (function (e) { if (e.length > J) return !0; for (var t = 0, n = 0; n < e.length; n++)if ((t += e[n].addedNodes.length) > J) return !0; return !1 }(t)) !a || H() ? r.forEach((function (t) { return (0, t.onHugeMutations)(e) })) : i || (z(o = function () { return r.forEach((function (t) { return (0, t.onHugeMutations)(e) })) }), i = !0), a = !0; else { var n = function (e) { var t = new Set, n = new Set, r = new Set; e.forEach((function (e) { F(e.addedNodes, (function (e) { e instanceof Element && e.isConnected && t.add(e) })), F(e.removedNodes, (function (e) { e instanceof Element && (e.isConnected ? (r.add(e), t.delete(e)) : n.add(e)) })) })); var o = [], a = []; return t.forEach((function (e) { t.has(e.parentElement) && o.push(e) })), n.forEach((function (e) { n.has(e.parentElement) && a.push(e) })), o.forEach((function (e) { return t.delete(e) })), a.forEach((function (e) { return n.delete(e) })), { additions: t, moves: r, deletions: n } }(t); r.forEach((function (e) { return (0, e.onMinorMutations)(n) })) } })), n.observe(e, { childList: !0, subtree: !0 }), te.set(e, n), r = new Set, ne.set(n, r) } return r.add(t), { disconnect: function () { r.delete(t), o && Q(o), 0 === r.size && (n.disconnect(), ne.delete(n), te.delete(e)) } } } var oe = new Map; function ae(e) { return ee || (ee = document.createElement("a")), ee.href = e, ee.href } function ie(e, t) { void 0 === t && (t = null); var n = "".concat(e).concat(t ? ";".concat(t) : ""); if (oe.has(n)) return oe.get(n); if (t) { var r = new URL(e, ae(t)); return oe.set(n, r), r } var o = new URL(ae(e)); return oe.set(e, o), o } function ue(e, t) { if (t.match(/^data\\?\:/)) return t; if (/^\/\//.test(t)) return "".concat(location.protocol).concat(t); var n = ie(e); return ie(t, n.href).href } function ce(e, t, n) { F(e, (function (e) { if (e.selectorText) t(e); else if (e.href) try { ce(e.styleSheet.cssRules, t, n) } catch (e) { n && n() } else if (e.media) { var r = Array.from(e.media), o = r.some((function (e) { return e.startsWith("screen") || e.startsWith("all") || e.startsWith("(") })), a = r.some((function (e) { return e.startsWith("print") || e.startsWith("speech") })); !o && a || ce(e.cssRules, t, n) } else e.conditionText && CSS.supports(e.conditionText) && ce(e.cssRules, t, n) })) } var se = ["background", "border", "border-color", "border-bottom", "border-left", "border-right", "border-top", "outline", "outline-color"], le = p ? se.map((function (e) { return [e, new RegExp("".concat(e, ":\\s*(.*?)\\s*;"))] })) : null; function de(e, t) { F(e, (function (n) { var r = e.getPropertyValue(n).trim(); r && t(n, r) })); var n = e.cssText; n.includes("var(") && (p ? le.forEach((function (e) { var r = i(e, 2), o = r[0], a = r[1], u = n.match(a); if (u && u[1]) { var c = u[1].trim(); t(o, c) } })) : se.forEach((function (n) { var r = e.getPropertyValue(n); r && r.includes("var(") && t(n, r) }))) } var fe = /url\((('.*?')|(".*?")|([^\)]*?))\)/g, he = /@import\s*(url\()?(('.+?')|(".+?")|([^\)]*?))\)? ?(screen)?;?/gi; function pe(e) { return e.trim().replace(/[\n\r\\]+/g, "").replace(/^url\((.*)\)$/, "$1").trim().replace(/^"(.*)"$/, "$1").replace(/^'(.*)'$/, "$1").replace(/(?:\\(.))/g, "$1") } function ve(e) { var t = ie(e); return "".concat(t.origin).concat(t.pathname.replace(/\?.*$/, "").replace(/(\/)([^\/]+)$/i, "$1")) } var me = /\/\*[\s\S]*?\*\//g; var ge = /@font-face\s*{[^}]*}/g; function ye(e) { for (var t, n = [], r = [], o = 0, a = e.length; o < a; o++) { var c = e[o]; if (c && " " !== c) { if (ke.has(c)) { for (var s = ke.get(c); r.length;) { var l = ke.get(r[0]); if (!l) break; if (!s.lessOrEqualThan(l)) break; n.push(r.shift()) } r.unshift(c) } else !t || ke.has(t) ? n.push(c) : n[n.length - 1] += c; t = c } } n.push.apply(n, u([], i(r), !1)); var d = []; for (o = 0, a = n.length; o < a; o++) { if (s = ke.get(n[o])) { var f = d.splice(0, 2); d.push(s.exec(f[1], f[0])) } else d.unshift(parseFloat(n[o])) } return d[0] } var be = function () { function e(e, t) { this.precendce = e, this.execMethod = t } return e.prototype.exec = function (e, t) { return this.execMethod(e, t) }, e.prototype.lessOrEqualThan = function (e) { return this.precendce <= e.precendce }, e }(), ke = new Map([["+", new be(1, (function (e, t) { return e + t }))], ["-", new be(1, (function (e, t) { return e - t }))], ["*", new be(2, (function (e, t) { return e * t }))], ["/", new be(2, (function (e, t) { return e / t }))]]); function Se(e, t, n) { void 0 === n && (n = 0); for (var r, o = []; r = e.exec(t);)o.push(r[n]); return o } function we(e, t) { void 0 === t && (t = 0); for (var n = e.length, r = 0, o = -1, a = t; a < n; a++)if (0 === r) { if ((i = e.indexOf("(", a)) < 0) break; o = i, r++, a = i } else { var i, u = e.indexOf(")", a); if (u < 0) break; if ((i = e.indexOf("(", a)) < 0 || u < i) { if (0 === --r) return { start: o, end: u + 1 }; a = u } else r++, a = i } return null } var Ee = new Map, Ce = new Map; function xe(e) { if (e = e.trim(), Ce.has(e)) return Ce.get(e); e.includes("calc(") && (e = function (e) { var t = 0, n = function (t, n, r) { e = e.substring(0, t) + r + e.substring(n) }; for (; -1 !== (t = e.indexOf("calc("));) { var r = we(e, t); if (!r) break; var o = e.slice(r.start + 1, r.end - 1), a = o.includes("%"); o = o.split("%").join(""); var i = Math.round(ye(o)); n(r.start - 4, r.end, i + (a ? "%" : "")) } return e }(e)); var t = function (e) { var t = e.trim().toLowerCase(); if (t.match(Me)) return n = i(Pe(t, De, Ie), 4), r = n[0], o = n[1], a = n[2], u = n[3], { r: r, g: o, b: a, a: void 0 === u ? 1 : u }; var n, r, o, a, u; if (t.match(Le)) return function (e) { var t = i(Pe(e, Ne, Fe), 4), n = t[0], r = t[1], o = t[2], a = t[3], u = void 0 === a ? 1 : a; return _e({ h: n, s: r, l: o, a: u }) }(t); if (t.match(Oe)) return function (e) { var t = e.substring(1); switch (t.length) { case 3: case 4: var n = i([0, 1, 2].map((function (e) { return parseInt("".concat(t[e]).concat(t[e]), 16) })), 3); return { r: n[0], g: n[1], b: n[2], a: 3 === t.length ? 1 : parseInt("".concat(t[3]).concat(t[3]), 16) / 255 }; case 6: case 8: var r = i([0, 2, 4].map((function (e) { return parseInt(t.substring(e, e + 2), 16) })), 3); return { r: r[0], g: r[1], b: r[2], a: 6 === t.length ? 1 : parseInt(t.substring(6, 8), 16) / 255 } }return null }(t); if (je.has(t)) return function (e) { var t = je.get(e); return { r: t >> 16 & 255, g: t >> 8 & 255, b: t >> 0 & 255, a: 1 } }(t); if (Be.has(t)) return function (e) { var t = Be.get(e); return { r: t >> 16 & 255, g: t >> 8 & 255, b: t >> 0 & 255, a: 1 } }(t); if ("transparent" === e) return { r: 0, g: 0, b: 0, a: 0 }; return null }(e); return t && Ce.set(e, t), t } function Te(e) { if (Ee.has(e)) return Ee.get(e); var t = xe(e); if (!t) return null; var n = Ve(t); return Ee.set(e, n), n } function _e(e) { var t = e.h, n = e.s, r = e.l, o = e.a, a = void 0 === o ? 1 : o; if (0 === n) { var u = i([r, r, r].map((function (e) { return Math.round(255 * e) })), 3), c = u[0], s = u[1]; return { r: c, g: u[2], b: s, a: a } } var l = (1 - Math.abs(2 * r - 1)) * n, d = l * (1 - Math.abs(t / 60 % 2 - 1)), f = r - l / 2, h = i((t < 60 ? [l, d, 0] : t < 120 ? [d, l, 0] : t < 180 ? [0, l, d] : t < 240 ? [0, d, l] : t < 300 ? [d, 0, l] : [l, 0, d]).map((function (e) { return Math.round(255 * (e + f)) })), 3); return { r: h[0], g: h[1], b: h[2], a: a } } function Ve(e) { var t = e.r, n = e.g, r = e.b, o = e.a, a = void 0 === o ? 1 : o, i = t / 255, u = n / 255, c = r / 255, s = Math.max(i, u, c), l = Math.min(i, u, c), d = s - l, f = (s + l) / 2; if (0 === d) return { h: 0, s: 0, l: f, a: a }; var h = 60 * (s === i ? (u - c) / d % 6 : s === u ? (c - i) / d + 2 : (i - u) / d + 4); return h < 0 && (h += 360), { h: h, s: d / (1 - Math.abs(2 * f - 1)), l: f, a: a } } function Re(e, t) { void 0 === t && (t = 0); var n = e.toFixed(t); if (0 === t) return n; var r = n.indexOf("."); if (r >= 0) { var o = n.match(/0+$/); if (o) return o.index === r + 1 ? n.substring(0, r) : n.substring(0, o.index) } return n } function Ae(e) { var t = e.h, n = e.s, r = e.l, o = e.a; return null != o && o < 1 ? "hsla(".concat(Re(t), ", ").concat(Re(100 * n), "%, ").concat(Re(100 * r), "%, ").concat(Re(o, 2), ")") : "hsl(".concat(Re(t), ", ").concat(Re(100 * n), "%, ").concat(Re(100 * r), "%)") } var Me = /^rgba?\([^\(\)]+\)$/, Le = /^hsla?\([^\(\)]+\)$/, Oe = /^#[0-9a-f]+$/i; function Pe(e, t, n) { var r = function (e) { var t = [], n = 0, r = !1, o = e.indexOf("("); e = e.substring(o + 1, e.length - 1); for (var a = 0; a < e.length; a++) { var i = e[a]; i >= "0" && i <= "9" || "." === i || "+" === i || "-" === i ? r = !0 : !r || " " !== i && "," !== i ? r || (n = a + 1) : (t.push(e.substring(n, a)), r = !1, n = a + 1) } return r && t.push(e.substring(n, e.length)), t }(e), o = Object.entries(n); return r.map((function (e) { return e.trim() })).map((function (e, n) { var r, a = o.find((function (t) { var n = i(t, 1)[0]; return e.endsWith(n) })); return r = a ? parseFloat(e.substring(0, e.length - a[0].length)) / a[1] * t[n] : parseFloat(e), t[n] > 1 ? Math.round(r) : r })) } var De = [255, 255, 255, 1], Ie = { "%": 100 }; var Ne = [360, 1, 1, 1], Fe = { "%": 100, deg: 360, rad: 2 * Math.PI, turn: 1 }; var je = new Map(Object.entries({ aliceblue: 15792383, antiquewhite: 16444375, aqua: 65535, aquamarine: 8388564, azure: 15794175, beige: 16119260, bisque: 16770244, black: 0, blanchedalmond: 16772045, blue: 255, blueviolet: 9055202, brown: 10824234, burlywood: 14596231, cadetblue: 6266528, chartreuse: 8388352, chocolate: 13789470, coral: 16744272, cornflowerblue: 6591981, cornsilk: 16775388, crimson: 14423100, cyan: 65535, darkblue: 139, darkcyan: 35723, darkgoldenrod: 12092939, darkgray: 11119017, darkgrey: 11119017, darkgreen: 25600, darkkhaki: 12433259, darkmagenta: 9109643, darkolivegreen: 5597999, darkorange: 16747520, darkorchid: 10040012, darkred: 9109504, darksalmon: 15308410, darkseagreen: 9419919, darkslateblue: 4734347, darkslategray: 3100495, darkslategrey: 3100495, darkturquoise: 52945, darkviolet: 9699539, deeppink: 16716947, deepskyblue: 49151, dimgray: 6908265, dimgrey: 6908265, dodgerblue: 2003199, firebrick: 11674146, floralwhite: 16775920, forestgreen: 2263842, fuchsia: 16711935, gainsboro: 14474460, ghostwhite: 16316671, gold: 16766720, goldenrod: 14329120, gray: 8421504, grey: 8421504, green: 32768, greenyellow: 11403055, honeydew: 15794160, hotpink: 16738740, indianred: 13458524, indigo: 4915330, ivory: 16777200, khaki: 15787660, lavender: 15132410, lavenderblush: 16773365, lawngreen: 8190976, lemonchiffon: 16775885, lightblue: 11393254, lightcoral: 15761536, lightcyan: 14745599, lightgoldenrodyellow: 16448210, lightgray: 13882323, lightgrey: 13882323, lightgreen: 9498256, lightpink: 16758465, lightsalmon: 16752762, lightseagreen: 2142890, lightskyblue: 8900346, lightslategray: 7833753, lightslategrey: 7833753, lightsteelblue: 11584734, lightyellow: 16777184, lime: 65280, limegreen: 3329330, linen: 16445670, magenta: 16711935, maroon: 8388608, mediumaquamarine: 6737322, mediumblue: 205, mediumorchid: 12211667, mediumpurple: 9662683, mediumseagreen: 3978097, mediumslateblue: 8087790, mediumspringgreen: 64154, mediumturquoise: 4772300, mediumvioletred: 13047173, midnightblue: 1644912, mintcream: 16121850, mistyrose: 16770273, moccasin: 16770229, navajowhite: 16768685, navy: 128, oldlace: 16643558, olive: 8421376, olivedrab: 7048739, orange: 16753920, orangered: 16729344, orchid: 14315734, palegoldenrod: 15657130, palegreen: 10025880, paleturquoise: 11529966, palevioletred: 14381203, papayawhip: 16773077, peachpuff: 16767673, peru: 13468991, pink: 16761035, plum: 14524637, powderblue: 11591910, purple: 8388736, rebeccapurple: 6697881, red: 16711680, rosybrown: 12357519, royalblue: 4286945, saddlebrown: 9127187, salmon: 16416882, sandybrown: 16032864, seagreen: 3050327, seashell: 16774638, sienna: 10506797, silver: 12632256, skyblue: 8900331, slateblue: 6970061, slategray: 7372944, slategrey: 7372944, snow: 16775930, springgreen: 65407, steelblue: 4620980, tan: 13808780, teal: 32896, thistle: 14204888, tomato: 16737095, turquoise: 4251856, violet: 15631086, wheat: 16113331, white: 16777215, whitesmoke: 16119285, yellow: 16776960, yellowgreen: 10145074 })), Be = new Map(Object.entries({ ActiveBorder: 3906044, ActiveCaption: 0, AppWorkspace: 11184810, Background: 6513614, ButtonFace: 16777215, ButtonHighlight: 15329769, ButtonShadow: 10461343, ButtonText: 0, CaptionText: 0, GrayText: 8355711, Highlight: 11720703, HighlightText: 0, InactiveBorder: 16777215, InactiveCaption: 16777215, InactiveCaptionText: 0, InfoBackground: 16514245, InfoText: 0, Menu: 16185078, MenuText: 16777215, Scrollbar: 11184810, ThreeDDarkShadow: 0, ThreeDFace: 12632256, ThreeDHighlight: 16777215, ThreeDLightShadow: 16777215, ThreeDShadow: 0, Window: 15527148, WindowFrame: 11184810, WindowText: 0, "-webkit-focus-ring-color": 15046400 }).map((function (e) { var t = i(e, 2), n = t[0], r = t[1]; return [n.toLowerCase(), r] }))); function qe(e, t, n) { return (.2126 * e + .7152 * t + .0722 * n) / 255 } function Ue(e, t, n, r, o) { return (e - t) * (o - r) / (n - t) + r } function We(e, t, n) { return Math.min(n, Math.max(t, e)) } function Ge(e, t) { for (var n = [], r = 0, o = e.length; r < o; r++) { n[r] = []; for (var a = 0, i = t[0].length; a < i; a++) { for (var u = 0, c = 0, s = e[0].length; c < s; c++)u += e[r][c] * t[c][a]; n[r][a] = u } } return n } function He(e) { var t = $e.identity(); return 0 !== e.sepia && (t = Ge(t, $e.sepia(e.sepia / 100))), 0 !== e.grayscale && (t = Ge(t, $e.grayscale(e.grayscale / 100))), 100 !== e.contrast && (t = Ge(t, $e.contrast(e.contrast / 100))), 100 !== e.brightness && (t = Ge(t, $e.brightness(e.brightness / 100))), 1 === e.mode && (t = Ge(t, $e.invertNHue())), t } var $e = { identity: function () { return [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]] }, invertNHue: function () { return [[.333, -.667, -.667, 0, 1], [-.667, .333, -.667, 0, 1], [-.667, -.667, .333, 0, 1], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]] }, brightness: function (e) { return [[e, 0, 0, 0, 0], [0, e, 0, 0, 0], [0, 0, e, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]] }, contrast: function (e) { var t = (1 - e) / 2; return [[e, 0, 0, 0, t], [0, e, 0, 0, t], [0, 0, e, 0, t], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]] }, sepia: function (e) { return [[.393 + .607 * (1 - e), .769 - .769 * (1 - e), .189 - .189 * (1 - e), 0, 0], [.349 - .349 * (1 - e), .686 + .314 * (1 - e), .168 - .168 * (1 - e), 0, 0], [.272 - .272 * (1 - e), .534 - .534 * (1 - e), .131 + .869 * (1 - e), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]] }, grayscale: function (e) { return [[.2126 + .7874 * (1 - e), .7152 - .7152 * (1 - e), .0722 - .0722 * (1 - e), 0, 0], [.2126 - .2126 * (1 - e), .7152 + .2848 * (1 - e), .0722 - .0722 * (1 - e), 0, 0], [.2126 - .2126 * (1 - e), .7152 - .7152 * (1 - e), .0722 + .9278 * (1 - e), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]] } }; function ze(e) { return e[1 === e.mode ? "darkSchemeBackgroundColor" : "lightSchemeBackgroundColor"] } function Qe(e) { return e[1 === e.mode ? "darkSchemeTextColor" : "lightSchemeTextColor"] } var Ke = new Map; var Ye = ["r", "g", "b", "a"], Xe = ["mode", "brightness", "contrast", "grayscale", "sepia", "darkSchemeBackgroundColor", "darkSchemeTextColor", "lightSchemeBackgroundColor", "lightSchemeTextColor"]; function Ze(e, t, n, r, o) { var a; Ke.has(n) ? a = Ke.get(n) : (a = new Map, Ke.set(n, a)); var u = function (e, t) { var n = ""; return Ye.forEach((function (t) { n += "".concat(e[t], ";") })), Xe.forEach((function (e) { n += "".concat(t[e], ";") })), n }(e, t); if (a.has(u)) return a.get(u); var c = _e(n(Ve(e), null == r ? null : Te(r), null == o ? null : Te(o))), s = c.r, l = c.g, d = c.b, f = c.a, h = i(function (e, t) { var n = i(e, 3), r = Ge(t, [[n[0] / 255], [n[1] / 255], [n[2] / 255], [1], [1]]); return [0, 1, 2].map((function (e) { return We(Math.round(255 * r[e][0]), 0, 255) })) }([s, l, d], He(t)), 3), p = h[0], v = h[1], m = h[2], g = 1 === f ? function (e) { var t = e.r, n = e.g, r = e.b, o = e.a; return "#".concat((null != o && o < 1 ? [t, n, r, Math.round(255 * o)] : [t, n, r]).map((function (e) { return "".concat(e < 16 ? "0" : "").concat(e.toString(16)) })).join("")) }({ r: p, g: v, b: m }) : function (e) { var t = e.r, n = e.g, r = e.b, o = e.a; return null != o && o < 1 ? "rgba(".concat(Re(t), ", ").concat(Re(n), ", ").concat(Re(r), ", ").concat(Re(o, 2), ")") : "rgb(".concat(Re(t), ", ").concat(Re(n), ", ").concat(Re(r), ")") }({ r: p, g: v, b: m, a: f }); return a.set(u, g), g } function Je(e) { return e } function et(e, t) { var n = ze(t); return Ze(e, t, tt, Qe(t), n) } function tt(e, t, n) { var r, o = e.h, a = e.s, i = e.l, u = e.a, c = i < .5; c ? r = i < .2 || a < .12 : r = a < .24 || i > .8 && (o > 200 && o < 280); var s = o, l = i; return r && (c ? (s = t.h, l = t.s) : (s = n.h, l = n.s)), { h: s, s: l, l: Ue(i, 0, 1, t.l, n.l), a: u } } var nt = .4; function rt(e, t) { var n = e.h, r = e.s, o = e.l, a = e.a, i = r < .12 || o > .8 && (n > 200 && n < 280); if (o < .5) { var u = Ue(o, 0, .5, 0, nt); return i ? { h: t.h, s: t.s, l: u, a: a } : { h: n, s: r, l: u, a: a } } var c = Ue(o, .5, 1, nt, t.l); if (i) return { h: t.h, s: t.s, l: c, a: a }; var s = n; n > 60 && n < 180 && (s = n > 120 ? Ue(n, 120, 180, 135, 180) : Ue(n, 60, 120, 60, 105)); return s > 40 && s < 80 && (c *= .75), { h: s, s: r, l: c, a: a } } function ot(e, t) { if (0 === t.mode) return et(e, t); var r = ze(t); return Ze(e, n(n({}, t), { mode: 0 }), rt, r) } var at, it = .55; function ut(e) { return Ue(e, 205, 245, 205, 220) } function ct(e, t) { var n = e.h, r = e.s, o = e.l, a = e.a, i = o < .2 || r < .24, u = !i && n > 205 && n < 245; if (o > .5) { var c = Ue(o, .5, 1, it, t.l); if (i) return { h: t.h, s: t.s, l: c, a: a }; var s = n; return u && (s = ut(n)), { h: s, s: r, l: c, a: a } } if (i) return { h: t.h, s: t.s, l: Ue(o, 0, .5, t.l, it), a: a }; var l, d = n; return u ? (d = ut(n), l = Ue(o, 0, .5, t.l, Math.min(1, it + .05))) : l = Ue(o, 0, .5, t.l, it), { h: d, s: r, l: l, a: a } } function st(e, t) { if (0 === t.mode) return et(e, t); var r = Qe(t); return Ze(e, n(n({}, t), { mode: 0 }), ct, r) } function lt(e, t, n) { var r = e.h, o = e.s, a = e.l, i = e.a, u = r, c = o; return (a < .2 || o < .24) && (a < .5 ? (u = t.h, c = t.s) : (u = n.h, c = n.s)), { h: u, s: c, l: Ue(a, 0, 1, .5, .2), a: i } } function dt(e, t) { if (0 === t.mode) return et(e, t); var r = Qe(t), o = ze(t); return Ze(e, n(n({}, t), { mode: 0 }), lt, r, o) } function ft(e, t) { return ot(e, t) } function ht(e) { var t = []; return e.mode === at.dark && t.push("invert(100%) hue-rotate(180deg)"), 100 !== e.brightness && t.push("brightness(".concat(e.brightness, "%)")), 100 !== e.contrast && t.push("contrast(".concat(e.contrast, "%)")), 0 !== e.grayscale && t.push("grayscale(".concat(e.grayscale, "%)")), 0 !== e.sepia && t.push("sepia(".concat(e.sepia, "%)")), 0 === t.length ? null : t.join(" ") } !function (e) { e[e.light = 0] = "light", e[e.dark = 1] = "dark" }(at || (at = {})); var pt = 0, vt = new Map, mt = new Map; function gt(e) { return r(this, void 0, void 0, (function () { return o(this, (function (n) { return [2, new Promise((function (n, r) { var o = ++pt; vt.set(o, n), mt.set(o, r), chrome.runtime.sendMessage({ type: t.CS_FETCH, data: e, id: o }) }))] })) })) } chrome.runtime.onMessage.addListener((function (e) { var n = e.type, r = e.data, o = e.error, a = e.id; if (n === t.BG_FETCH_RESPONSE) { var i = vt.get(a), u = mt.get(a); vt.delete(a), mt.delete(a), o ? u && u(o) : i && i(r) } })); var yt = new (function () { function e() { this.queue = [], this.timerId = null, this.frameDuration = 1e3 / 60 } return e.prototype.addToQueue = function (e) { this.queue.push(e), this.startQueue() }, e.prototype.stopQueue = function () { null !== this.timerId && (cancelAnimationFrame(this.timerId), this.timerId = null), this.queue = [] }, e.prototype.startQueue = function () { var e = this; this.timerId || (this.timerId = requestAnimationFrame((function () { e.timerId = null; for (var t, n = Date.now(); t = e.queue.shift();)if (t(), Date.now() - n >= e.frameDuration) { e.startQueue(); break } }))) }, e }()); function bt(e) { return r(this, void 0, void 0, (function () { var t = this; return o(this, (function (a) { return [2, new Promise((function (a, i) { return r(t, void 0, void 0, (function () { var t, r, u, c; return o(this, (function (o) { switch (o.label) { case 0: return e.startsWith("data:") ? (t = e, [3, 4]) : [3, 1]; case 1: return o.trys.push([1, 3, , 4]), [4, kt(e)]; case 2: return t = o.sent(), [3, 4]; case 3: return r = o.sent(), i(r), [2]; case 4: return o.trys.push([4, 6, , 7]), [4, St(t)]; case 5: return u = o.sent(), yt.addToQueue((function () { a(n({ src: e, dataURL: t, width: u.naturalWidth, height: u.naturalHeight }, function (e) { wt || (t = Ct, n = Ct, (wt = document.createElement("canvas")).width = t, wt.height = n, (Et = wt.getContext("2d", { willReadFrequently: !0 })).imageSmoothingEnabled = !1); var t, n; var r = e.naturalWidth, o = e.naturalHeight; if (0 === o || 0 === r) return "logWarn(Image is empty ".concat(e.currentSrc, ")"), null; if (r * o * 4 > xt) return { isDark: !1, isLight: !1, isTransparent: !1, isLarge: !1, isTooLarge: !0 }; var a = r * o, i = Math.min(1, Math.sqrt(Ct / a)), u = Math.ceil(r * i), c = Math.ceil(o * i); Et.clearRect(0, 0, u, c), Et.drawImage(e, 0, 0, r, o, 0, 0, u, c); var s, l, d, f, h, p, v, m = Et.getImageData(0, 0, u, c).data, g = .05, y = .4, b = .7, k = 0, S = 0, w = 0; for (d = 0; d < c; d++)for (l = 0; l < u; l++)f = m[(s = 4 * (d * u + l)) + 0], h = m[s + 1], p = m[s + 2], m[s + 3] / 255 < g ? k++ : ((v = qe(f, h, p)) < y && S++, v > b && w++); var E = u * c, C = E - k; return { isDark: S / C >= .7, isLight: w / C >= .7, isTransparent: k / E >= .1, isLarge: a >= 48e4, isTooLarge: !1 } }(u))) })), [3, 7]; case 6: return c = o.sent(), i(c), [3, 7]; case 7: return [2] } })) })) }))] })) })) } function kt(e) { return r(this, void 0, void 0, (function () { return o(this, (function (t) { switch (t.label) { case 0: return new URL(e).origin !== location.origin ? [3, 2] : [4, E(e)]; case 1: case 3: return [2, t.sent()]; case 2: return [4, gt({ url: e, responseType: "data-url" })] } })) })) } function St(e) { return r(this, void 0, void 0, (function () { return o(this, (function (t) { return [2, new Promise((function (t, n) { var r = new Image; r.onload = function () { return t(r) }, r.onerror = function () { return n("Unable to load image ".concat(e)) }, r.src = e }))] })) })) } var wt, Et, Ct = 1024; var xt = 5242880; function Tt(e, t) { var n = e.dataURL, r = e.width, o = e.height, a = He(t).slice(0, 4).map((function (e) { return e.map((function (e) { return e.toFixed(3) })).join(" ") })).join(" "), i = ['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'.concat(r, '" height="').concat(o, '">'), "<defs>", '<filter id="dusky-dark-image-filter">', '<feColorMatrix type="matrix" values="'.concat(a, '" />'), "</filter>", "</defs>", '<image width="'.concat(r, '" height="').concat(o, '" filter="url(#dusky-dark-image-filter)" xlink:href="').concat(n, '" />'), "</svg>"].join(""); return "data:image/svg+xml;base64,".concat(btoa(i)) } function _t() { yt && yt.stopQueue(), wt = null, Et = null } var Vt = 8, Rt = "conic-", At = Rt.length, Mt = "radial-", Lt = "linear-"; function Ot(e, t) { return Boolean(e && e.getPropertyPriority(t)) } function Pt(e, t, n, r, o, a) { if (e.startsWith("--")) { var i = function (e, t, n, r, o, a) { return e.getModifierForVariable({ varName: t, sourceValue: n, rule: r, ignoredImgSelectors: o, isCancelled: a }) }(r, e, t, n, o, a); if (i) return { property: e, value: i, important: Ot(n.style, e), sourceValue: t } } else if (t.includes("var(")) { i = function (e, t, n) { return e.getModifierForVarDependant(t, n) }(r, e, t); if (i) return { property: e, value: i, important: Ot(n.style, e), sourceValue: t } } else { if ("color-scheme" === e) return null; if (e.includes("color") && "-webkit-print-color-adjust" !== e || "fill" === e || "stroke" === e || "stop-color" === e) { i = function (e, t, n) { if (jt.has(t.toLowerCase())) return t; var r = xe(t); if (!r) return null; if (e.includes("background")) return n.style.webkitMaskImage && "none" !== n.style.webkitMaskImage || n.style.webkitMask && !n.style.webkitMask.startsWith("none") || n.style.mask && "none" !== n.style.mask || n.style.getPropertyValue("mask-image") && "none" !== n.style.getPropertyValue("mask-image") ? function (e) { return st(r, e) } : function (e) { return ot(r, e) }; if (e.includes("border") || e.includes("outline")) return function (e) { return dt(r, e) }; return function (e) { return st(r, e) } }(e, t, n); if (i) return { property: e, value: i, important: Ot(n.style, e), sourceValue: t } } else if ("background-image" === e || "list-style-image" === e) { if (i = Ut(t, n, o, a)) return { property: e, value: i, important: Ot(n.style, e), sourceValue: t } } else if (e.includes("shadow")) { i = function (e) { var t = Wt(e); if (!t) return null; return function (e) { return t(e).result } }(t); if (i) return { property: e, value: i, important: Ot(n.style, e), sourceValue: t } } } return null } function Dt() { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return e.filter(Boolean).join(", ") } function It(e, t, r) { var o = []; t || (o.push("html {"), o.push("    background-color: ".concat(ot({ r: 255, g: 255, b: 255 }, e), " !important;")), o.push("}")), S && (o.push("html {"), o.push("    color-scheme: ".concat(1 === e.mode ? "dark" : "dark light", " !important;")), o.push("}")); var a = Dt(t ? "" : "html, body", r ? "input, textarea, select, button, dialog" : ""); return a && (o.push("".concat(a, " {")), o.push("    background-color: ".concat(ot({ r: 255, g: 255, b: 255 }, e), ";")), o.push("}")), o.push("".concat(Dt("html, body", r ? "input, textarea, select, button" : ""), " {")), o.push("    border-color: ".concat(dt({ r: 76, g: 76, b: 76 }, e), ";")), o.push("    color: ".concat(st({ r: 0, g: 0, b: 0 }, e), ";")), o.push("}"), o.push("a {"), o.push("    color: ".concat(st({ r: 0, g: 64, b: 255 }, e), ";")), o.push("}"), o.push("table {"), o.push("    border-color: ".concat(dt({ r: 128, g: 128, b: 128 }, e), ";")), o.push("}"), o.push("::placeholder {"), o.push("    color: ".concat(st({ r: 169, g: 169, b: 169 }, e), ";")), o.push("}"), o.push("input:-webkit-autofill,"), o.push("textarea:-webkit-autofill,"), o.push("select:-webkit-autofill {"), o.push("    background-color: ".concat(ot({ r: 250, g: 255, b: 189 }, e), " !important;")), o.push("    color: ".concat(st({ r: 0, g: 0, b: 0 }, e), " !important;")), o.push("}"), e.scrollbarColor && o.push(function (e) { var t, r, o, a, i, u, c = []; if ("auto" === e.scrollbarColor) t = ot({ r: 241, g: 241, b: 241 }, e), r = st({ r: 96, g: 96, b: 96 }, e), o = ot({ r: 176, g: 176, b: 176 }, e), a = ot({ r: 144, g: 144, b: 144 }, e), i = ot({ r: 96, g: 96, b: 96 }, e), u = ot({ r: 255, g: 255, b: 255 }, e); else { var s = Ve(xe(e.scrollbarColor)), l = s.l > .5, d = function (e) { return n(n({}, s), { l: We(s.l + e, 0, 1) }) }, f = function (e) { return n(n({}, s), { l: We(s.l - e, 0, 1) }) }; t = Ae(f(.4)), r = Ae(l ? f(.4) : d(.4)), o = Ae(s), a = Ae(d(.1)), i = Ae(d(.2)) } c.push("::-webkit-scrollbar {"), c.push("    background-color: ".concat(t, ";")), c.push("    color: ".concat(r, ";")), c.push("}"), c.push("::-webkit-scrollbar-thumb {"), c.push("    background-color: ".concat(o, ";")), c.push("}"), c.push("::-webkit-scrollbar-thumb:hover {"), c.push("    background-color: ".concat(a, ";")), c.push("}"), c.push("::-webkit-scrollbar-thumb:active {"), c.push("    background-color: ".concat(i, ";")), c.push("}"), c.push("::-webkit-scrollbar-corner {"), c.push("    background-color: ".concat(u, ";")), c.push("}"), h && (c.push("* {"), c.push("    scrollbar-color: ".concat(o, " ").concat(t, ";")), c.push("}")); return c.join("\n") }(e)), e.selectionColor && o.push(function (e) { var t = [], n = Nt(e), r = n.backgroundColorSelection, o = n.foregroundColorSelection; return ["::selection", "::-moz-selection"].forEach((function (e) { t.push("".concat(e, " {")), t.push("    background-color: ".concat(r, " !important;")), t.push("    color: ".concat(o, " !important;")), t.push("}") })), t.join("\n") }(e)), o.join("\n") } function Nt(e) { var t, r; if ("auto" === e.selectionColor) t = ot({ r: 0, g: 96, b: 212 }, n(n({}, e), { grayscale: 0 })), r = st({ r: 255, g: 255, b: 255 }, n(n({}, e), { grayscale: 0 })); else { var o = Ve(xe(e.selectionColor)); t = e.selectionColor, r = o.l < .5 ? "#FFF" : "#000" } return { backgroundColorSelection: t, foregroundColorSelection: r } } function Ft(e, t) { var n = t.strict, r = [], o = ["microsoft.com", "docs.microsoft.com"].includes(location.hostname); return r.push("html, body, ".concat(n ? "body :not(iframe)".concat(o ? ':not(div[style^="position:absolute;top:0;left:-"]' : "") : "body > :not(iframe)", " {")), r.push("    background-color: ".concat(ot({ r: 255, g: 255, b: 255 }, e), " !important;")), r.push("    border-color: ".concat(dt({ r: 64, g: 64, b: 64 }, e), " !important;")), r.push("    color: ".concat(st({ r: 0, g: 0, b: 0 }, e), " !important;")), r.push("}"), r.join("\n") } var jt = new Set(["inherit", "transparent", "initial", "currentcolor", "none", "unset"]); var Bt = new Map, qt = new Map; function Ut(e, t, a, i) { var u, c, s = this; try { var l = function (e) { for (var t = [], n = 0, r = Rt.length, o = function () { var o; if ([Lt, Mt, Rt].find((function (t) { if (n - t.length >= 0 && e.substring(n - t.length, n) === t) return "repeating" === e.slice(n - t.length - 10, n - t.length - 1) ? (o = "repeating-".concat(t, "gradient"), !0) : "-webkit" === e.slice(n - t.length - 8, n - t.length - 1) ? (o = "-webkit-".concat(t, "gradient"), !0) : (o = "".concat(t, "gradient"), !0) })), !o) return "break"; var a = we(e, n + Vt), i = a.start, u = a.end, c = e.substring(i + 1, u - 1); r = u + 1 + At, t.push({ typeGradient: o, match: c, offset: o.length + 2, index: n - o.length + Vt, hasComma: !0 }) }; -1 !== (n = e.indexOf("gradient", r)) && "break" !== o();); return t.length && (t[t.length - 1].hasComma = !1), t }(e), d = Se(fe, e); if (0 === d.length && 0 === l.length) return e; var f = l.map((function (e) { return n({ type: "gradient" }, e) })).concat((u = d, c = 0, u.map((function (t) { var n = e.indexOf(t, c); return c = n + t.length, { match: t, index: n } }))).map((function (e) { return n({ type: "url", offset: 0 }, e) }))).sort((function (e, t) { return e.index > t.index ? 1 : -1 })), h = function (e, t) { var r, o = e.isDark, a = e.isLight, i = e.isTransparent, u = e.isLarge, c = e.isTooLarge, s = e.width; if (c) r = 'url("'.concat(e.src, '")'); else if (o && i && 1 === t.mode && !u && s > 2) { "Inverting dark image ".concat(e.src); var l = Tt(e, n(n({}, t), { sepia: We(t.sepia + 10, 0, 100) })); r = 'url("'.concat(l, '")') } else if (a && !i && 1 === t.mode) if (u) r = "none"; else { "Dimming light image ".concat(e.src); var d = Tt(e, t); r = 'url("'.concat(d, '")') } else if (0 === t.mode && a && !u) { "Applying filter to image ".concat(e.src); var f = Tt(e, n(n({}, t), { brightness: We(t.brightness - 10, 5, 200), sepia: We(t.sepia + 10, 0, 100) })); r = 'url("'.concat(f, '")') } else r = null; return r }, p = [], v = 0, m = !1; return f.forEach((function (n, u) { var c = n.type, l = n.match, d = n.index, g = n.typeGradient, y = n.hasComma, b = n.offset, k = d, S = v, w = k + l.length + b; v = w, S !== k && (m ? p.push((function () { var t = e.substring(S, k); return "," === t[0] && (t = t.substring(1)), t })) : p.push((function () { return e.substring(S, k) }))), m = y || !1, "url" === c ? p.push(function (e) { var n; if (function (e, t) { if (!e || 0 === t.length) return !1; if (t.some((function (e) { return "*" === e }))) return !0; for (var n = e.split(/,\s*/g), r = function (e) { var r = t[e]; if (n.some((function (e) { return e === r }))) return { value: !0 } }, o = 0; o < t.length; o++) { var a = r(o); if ("object" == typeof a) return a.value } return !1 }(t.selectorText, a)) return null; var u = pe(e), c = 0 === u.length, l = t.parentStyleSheet, d = l && l.href ? ve(l.href) : (null === (n = l.ownerNode) || void 0 === n ? void 0 : n.baseURI) || location.origin; u = ue(d, u); var f = 'url("'.concat(u, '")'); return function (e) { return r(s, void 0, void 0, (function () { var t, n; return o(this, (function (r) { switch (r.label) { case 0: return c ? [2, "url('')"] : Bt.has(u) ? (t = Bt.get(u), [3, 7]) : [3, 1]; case 1: return r.trys.push([1, 6, , 7]), qt.has(u) ? (n = qt.get(u), [4, new Promise((function (e) { return n.push(e) }))]) : [3, 3]; case 2: return (t = r.sent()) ? [3, 5] : [2, null]; case 3: return qt.set(u, []), [4, bt(u)]; case 4: t = r.sent(), Bt.set(u, t), qt.get(u).forEach((function (e) { return e(t) })), qt.delete(u), r.label = 5; case 5: return i() ? [2, null] : [3, 7]; case 6: return r.sent(), qt.has(u) && (qt.get(u).forEach((function (e) { return e(null) })), qt.delete(u)), [2, f]; case 7: return [2, h(t, e) || f] } })) })) } }(l)) : "gradient" === c && p.push(function (e) { var t = e.typeGradient, n = e.match, r = e.hasComma, o = /^(from|color-stop|to)\(([^\(\)]*?,\s*)?(.*?)\)$/, a = Se(/([^\(\),]+(\([^\(\)]*(\([^\(\)]*\)*[^\(\)]*)?\))?([^\(\), ]|( (?!calc)))*),?/g, n, 1).map((function (e) { var t = xe(e = e.trim()); if (t) return function (e) { return ft(t, e) }; var n = e.lastIndexOf(" "); if (t = xe(e.substring(0, n))) return function (r) { return "".concat(ft(t, r), " ").concat(e.substring(n + 1)) }; var r = e.match(o); return r && (t = xe(r[3])) ? function (e) { return "".concat(r[1], "(").concat(r[2] ? "".concat(r[2], ", ") : "").concat(ft(t, e), ")") } : function () { return e } })); return function (e) { return "".concat(t, "(").concat(a.map((function (t) { return t(e) })).join(", "), ")").concat(r ? ", " : "") } }({ match: l, index: d, typeGradient: g, hasComma: y, offset: b })), u === f.length - 1 && p.push((function () { return e.substring(w) })) })), function (e) { var t = p.filter(Boolean).map((function (t) { return t(e) })); if (t.some((function (e) { return e instanceof Promise }))) return Promise.all(t).then((function (e) { return e.filter(Boolean).join("") })); var n = t.join(""); return n.endsWith(", initial") ? n.slice(0, -9) : n } } catch (e) { return null } } function Wt(e) { try { var t = 0, n = Se(/(^|\s)(?!calc)([a-z]+\(.+?\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/gi, e, 2), r = 0, o = n.map((function (o, a) { var i = t, u = e.indexOf(o, t), c = u + o.length; t = c; var s = xe(o); return s ? function (t) { return "".concat(e.substring(i, u)).concat(function (e, t) { return ot(e, t) }(s, t)).concat(a === n.length - 1 ? e.substring(c) : "") } : (r++, function () { return e.substring(i, c) }) })); return function (e) { var t = o.map((function (t) { return t(e) })).join(""); return { matchesLength: n.length, unparseableMatchesLength: r, result: t } } } catch (e) { return null } } function Gt() { Ke.clear(), Bt.clear(), _t(), qt.clear() } var Ht = new (function () { function e() { this.varTypes = new Map, this.rulesQueue = [], this.definedVars = new Set, this.varRefs = new Map, this.unknownColorVars = new Set, this.unknownBgVars = new Set, this.undefinedVars = new Set, this.initialVarTypes = new Map, this.changedTypeVars = new Set, this.typeChangeSubscriptions = new Map, this.unstableVarValues = new Map } return e.prototype.clear = function () { this.varTypes.clear(), this.rulesQueue.splice(0), this.definedVars.clear(), this.varRefs.clear(), this.unknownColorVars.clear(), this.unknownBgVars.clear(), this.undefinedVars.clear(), this.initialVarTypes.clear(), this.changedTypeVars.clear(), this.typeChangeSubscriptions.clear(), this.unstableVarValues.clear() }, e.prototype.isVarType = function (e, t) { return this.varTypes.has(e) && (this.varTypes.get(e) & t) > 0 }, e.prototype.addRulesForMatching = function (e) { this.rulesQueue.push(e) }, e.prototype.matchVariablesAndDependants = function () { var e = this; this.changedTypeVars.clear(), this.initialVarTypes = new Map(this.varTypes), this.collectRootVariables(), this.collectVariablesAndVarDep(this.rulesQueue), this.rulesQueue.splice(0), this.collectRootVarDependants(), this.varRefs.forEach((function (t, n) { t.forEach((function (t) { e.varTypes.has(n) && e.resolveVariableType(t, e.varTypes.get(n)) })) })), this.unknownColorVars.forEach((function (t) { e.unknownBgVars.has(t) ? (e.unknownColorVars.delete(t), e.unknownBgVars.delete(t), e.resolveVariableType(t, 1)) : e.isVarType(t, 7) ? e.unknownColorVars.delete(t) : e.undefinedVars.add(t) })), this.unknownBgVars.forEach((function (t) { null != e.findVarRef(t, (function (t) { return e.unknownColorVars.has(t) || e.isVarType(t, 6) })) ? e.itarateVarRefs(t, (function (t) { e.resolveVariableType(t, 1) })) : e.isVarType(t, 9) ? e.unknownBgVars.delete(t) : e.undefinedVars.add(t) })), this.changedTypeVars.forEach((function (t) { e.typeChangeSubscriptions.has(t) && e.typeChangeSubscriptions.get(t).forEach((function (e) { e() })) })), this.changedTypeVars.clear() }, e.prototype.getModifierForVariable = function (e) { var t = this; return function (n) { var r = e.varName, o = e.sourceValue, a = e.rule, i = e.ignoredImgSelectors, u = e.isCancelled, c = function () { var e = [], c = function (a, i, u) { if (t.isVarType(r, a)) { var c, s = i(r); if (tn(o)) if (nn(o)) { var l = ln(o, t.unstableVarValues); l || (l = 1 === a ? "#ffffff" : "#000000"), c = u(l, n) } else c = Kt(o, (function (e) { return i(e) }), (function (e) { return u(e, n) })); else c = u(o, n); e.push({ property: s, value: c }) } }; if (c(1, Yt, un), c(2, Xt, cn), c(4, Zt, sn), t.isVarType(r, 8)) { var s = Jt(r), l = o; tn(o) && (l = Kt(o, (function (e) { return Yt(e) }), (function (e) { return un(e, n) }))); var d = Ut(l, a, i, u); l = "function" == typeof d ? d(n) : d, e.push({ property: s, value: l }) } return e }, s = new Set; return { declarations: c(), onTypeChange: { addListener: function (e) { var n = function () { var t = c(); e(t) }; s.add(n), t.subscribeForVarTypeChange(r, n) }, removeListeners: function () { s.forEach((function (e) { t.unsubscribeFromVariableTypeChanges(r, e) })) } } } } }, e.prototype.getModifierForVarDependant = function (e, t) { var n = this; if (t.match(/^\s*(rgb|hsl)a?\(/)) { var r = e.startsWith("background"), o = rn(e); return function (e) { var a = ln(t, n.unstableVarValues); return a || (a = r ? "#ffffff" : "#000000"), (r ? un : o ? cn : sn)(a, e) } } return "background-color" === e ? function (e) { return Kt(t, (function (e) { return Yt(e) }), (function (t) { return un(t, e) })) } : rn(e) ? function (e) { return Kt(t, (function (e) { return Xt(e) }), (function (t) { return cn(t, e) })) } : "background" === e || "background-image" === e || "box-shadow" === e ? function (r) { var o = new Set, a = function () { var a = Kt(t, (function (e) { return n.isVarType(e, 1) ? Yt(e) : n.isVarType(e, 8) ? Jt(e) : (o.add(e), e) }), (function (e) { return un(e, r) })); if ("box-shadow" === e) { var i = Wt(a)(r); if (i.unparseableMatchesLength !== i.matchesLength) return i.result } return a }, i = a(); return o.size > 0 ? new Promise((function (e) { var t = o.values().next().value, r = function () { n.unsubscribeFromVariableTypeChanges(t, r); var o = a(); e(o) }; n.subscribeForVarTypeChange(t, r) })) : i } : e.startsWith("border") || e.startsWith("outline") ? function (e) { return Kt(t, (function (e) { return Zt(e) }), (function (t) { return sn(t, e) })) } : null }, e.prototype.subscribeForVarTypeChange = function (e, t) { this.typeChangeSubscriptions.has(e) || this.typeChangeSubscriptions.set(e, new Set); var n = this.typeChangeSubscriptions.get(e); n.has(t) || n.add(t) }, e.prototype.unsubscribeFromVariableTypeChanges = function (e, t) { this.typeChangeSubscriptions.has(e) && this.typeChangeSubscriptions.get(e).delete(t) }, e.prototype.collectVariablesAndVarDep = function (e) { var t = this; e.forEach((function (e) { ce(e, (function (e) { e.style && de(e.style, (function (e, n) { en(e) && t.inspectVariable(e, n), tn(n) && t.inspectVarDependant(e, n) })) })) })) }, e.prototype.collectRootVariables = function () { var e = this; de(document.documentElement.style, (function (t, n) { en(t) && e.inspectVariable(t, n) })) }, e.prototype.inspectVariable = function (e, t) { (this.unstableVarValues.set(e, t), tn(t) && nn(t) && (this.unknownColorVars.add(e), this.definedVars.add(e)), this.definedVars.has(e)) || (this.definedVars.add(e), xe(t) ? this.unknownColorVars.add(e) : (t.includes("url(") || t.includes("linear-gradient(") || t.includes("radial-gradient(")) && this.resolveVariableType(e, 8)) }, e.prototype.resolveVariableType = function (e, t) { var n = this.initialVarTypes.get(e) || 0, r = (this.varTypes.get(e) || 0) | t; this.varTypes.set(e, r), (r !== n || this.undefinedVars.has(e)) && (this.changedTypeVars.add(e), this.undefinedVars.delete(e)), this.unknownColorVars.delete(e), this.unknownBgVars.delete(e) }, e.prototype.collectRootVarDependants = function () { var e = this; de(document.documentElement.style, (function (t, n) { tn(n) && e.inspectVarDependant(t, n) })) }, e.prototype.inspectVarDependant = function (e, t) { var n = this; en(e) ? this.iterateVarDeps(t, (function (t) { n.varRefs.has(e) || n.varRefs.set(e, new Set), n.varRefs.get(e).add(t) })) : "background-color" === e || "box-shadow" === e ? this.iterateVarDeps(t, (function (e) { return n.resolveVariableType(e, 1) })) : rn(e) ? this.iterateVarDeps(t, (function (e) { return n.resolveVariableType(e, 2) })) : e.startsWith("border") || e.startsWith("outline") ? this.iterateVarDeps(t, (function (e) { return n.resolveVariableType(e, 4) })) : "background" !== e && "background-image" !== e || this.iterateVarDeps(t, (function (e) { if (!n.isVarType(e, 9)) { var t = null != n.findVarRef(e, (function (e) { return n.unknownColorVars.has(e) || n.isVarType(e, 6) })); n.itarateVarRefs(e, (function (e) { t ? n.resolveVariableType(e, 1) : n.unknownBgVars.add(e) })) } })) }, e.prototype.iterateVarDeps = function (e, t) { var n = new Set; !function (e, t) { Kt(e, (function (e) { return t(e), e })) }(e, (function (e) { return n.add(e) })), n.forEach((function (e) { return t(e) })) }, e.prototype.findVarRef = function (e, t, n) { var r, o; if (void 0 === n && (n = new Set), n.has(e)) return null; if (n.add(e), t(e)) return e; var i = this.varRefs.get(e); if (!i || 0 === i.size) return null; try { for (var u = a(i), c = u.next(); !c.done; c = u.next()) { var s = c.value, l = this.findVarRef(s, t, n); if (l) return l } } catch (e) { r = { error: e } } finally { try { c && !c.done && (o = u.return) && o.call(u) } finally { if (r) throw r.error } } return null }, e.prototype.itarateVarRefs = function (e, t) { this.findVarRef(e, (function (e) { return t(e), !1 })) }, e.prototype.setOnRootVariableChange = function (e) { this.onRootVariableDefined = e }, e.prototype.putRootVars = function (e, t) { var n, r, o = this, u = e.sheet; u.cssRules.length > 0 && u.deleteRule(0); var c = new Map; de(document.documentElement.style, (function (e, n) { en(e) && (o.isVarType(e, 1) && c.set(Yt(e), un(n, t)), o.isVarType(e, 2) && c.set(Xt(e), cn(n, t)), o.isVarType(e, 4) && c.set(Zt(e), sn(n, t)), o.subscribeForVarTypeChange(e, o.onRootVariableDefined)) })); var s = []; s.push(":root {"); try { for (var l = a(c), d = l.next(); !d.done; d = l.next()) { var f = i(d.value, 2), h = f[0], p = f[1]; s.push("    ".concat(h, ": ").concat(p, ";")) } } catch (e) { n = { error: e } } finally { try { d && !d.done && (r = l.return) && r.call(l) } finally { if (n) throw n.error } } s.push("}"); var v = s.join("\n"); u.insertRule(v) }, e }()); function $t(e, t) { void 0 === t && (t = 0); var n = e.indexOf("var(", t); if (n >= 0) { var r = we(e, n + 3); return r ? { start: n, end: r.end } : null } } function zt(e, t) { var n = function (e) { for (var t, n = [], r = 0; t = $t(e, r);) { var o = t.start, a = t.end; n.push({ start: o, end: a, value: e.substring(o, a) }), r = t.end + 1 } return n }(e), r = n.length; if (0 === r) return e; var o = e.length, a = n.map((function (e) { return t(e.value) })), i = []; i.push(e.substring(0, n[0].start)); for (var u = 0; u < r; u++) { i.push(a[u]); var c = n[u].end, s = u < r - 1 ? n[u + 1].start : o; i.push(e.substring(c, s)) } return i.join("") } function Qt(e) { var t, n, r = e.indexOf(","); return r >= 0 ? (t = e.substring(4, r).trim(), n = e.substring(r + 1, e.length - 1).trim()) : (t = e.substring(4, e.length - 1).trim(), n = ""), { name: t, fallback: n } } function Kt(e, t, n) { return zt(e, (function (e) { var r, o = Qt(e), a = o.name, i = o.fallback, u = t(a); return i ? (r = tn(i) ? Kt(i, t, n) : n ? n(i) : i, "var(".concat(u, ", ").concat(r, ")")) : "var(".concat(u, ")") })) } function Yt(e) { return "--dusky-dark-mode-bg".concat(e) } function Xt(e) { return "--dusky-dark-mode-text".concat(e) } function Zt(e) { return "--dusky-dark-mode-border".concat(e) } function Jt(e) { return "--dusky-dark-mode-bgimg".concat(e) } function en(e) { return e.startsWith("--") } function tn(e) { return e.includes("var(") } function nn(e) { return e.match(/^\s*(rgb|hsl)a?\(/) } function rn(e) { return "color" === e || "caret-color" === e || "-webkit-text-fill-color" === e } var on = /^\d{1,3}, ?\d{1,3}, ?\d{1,3}$/; function an(e, t, n) { var r = function (e) { if (on.test(e)) { var t = e.split(","), n = "rgb("; return t.forEach((function (e) { n += "".concat(e.trim(), ", ") })), n = n.substring(0, n.length - 2), { isRaw: !0, color: n += ")" } } return { isRaw: !1, color: e } }(e), o = r.isRaw, a = r.color, i = xe(a); if (i) { var u = n(i, t); if (o) { var c = xe(u); return c ? "".concat(c.r, ", ").concat(c.g, ", ").concat(c.b) : u } return u } return a } function un(e, t) { return an(e, t, ot) } function cn(e, t) { return an(e, t, st) } function sn(e, t) { return an(e, t, dt) } function ln(e, t, n) { void 0 === n && (n = new Set); var r = !1, o = zt(e, (function (e) { var o = Qt(e), a = o.name, i = o.fallback; if (n.has(a)) return r = !0, null; n.add(a); var u = t.get(a) || i, c = null; return u && (c = tn(u) ? ln(u, t, n) : u), c || (r = !0, null) })); return r ? null : o } var dn = { "background-color": { customProp: "--dusky-dark-mode-inline-bgcolor", cssProp: "background-color", dataAttr: "data-dusky-dark-inline-bgcolor" }, "background-image": { customProp: "--dusky-dark-mode-inline-bgimage", cssProp: "background-image", dataAttr: "data-dusky-dark-inline-bgimage" }, "border-color": { customProp: "--dusky-dark-mode-inline-border", cssProp: "border-color", dataAttr: "data-dusky-dark-inline-border" }, "border-bottom-color": { customProp: "--dusky-dark-mode-inline-border-bottom", cssProp: "border-bottom-color", dataAttr: "data-dusky-dark-inline-border-bottom" }, "border-left-color": { customProp: "--dusky-dark-mode-inline-border-left", cssProp: "border-left-color", dataAttr: "data-dusky-dark-inline-border-left" }, "border-right-color": { customProp: "--dusky-dark-mode-inline-border-right", cssProp: "border-right-color", dataAttr: "data-dusky-dark-inline-border-right" }, "border-top-color": { customProp: "--dusky-dark-mode-inline-border-top", cssProp: "border-top-color", dataAttr: "data-dusky-dark-inline-border-top" }, "box-shadow": { customProp: "--dusky-dark-mode-inline-boxshadow", cssProp: "box-shadow", dataAttr: "data-dusky-dark-inline-boxshadow" }, color: { customProp: "--dusky-dark-mode-inline-color", cssProp: "color", dataAttr: "data-dusky-dark-inline-color" }, fill: { customProp: "--dusky-dark-mode-inline-fill", cssProp: "fill", dataAttr: "data-dusky-dark-inline-fill" }, stroke: { customProp: "--dusky-dark-mode-inline-stroke", cssProp: "stroke", dataAttr: "data-dusky-dark-inline-stroke" }, "outline-color": { customProp: "--dusky-dark-mode-inline-outline", cssProp: "outline-color", dataAttr: "data-dusky-dark-inline-outline" }, "stop-color": { customProp: "--dusky-dark-mode-inline-stopcolor", cssProp: "stop-color", dataAttr: "data-dusky-dark-inline-stopcolor" } }, fn = Object.values(dn), hn = {}; fn.forEach((function (e) { var t = e.cssProp, n = e.customProp; return hn[n] = t })); var pn = ["style", "fill", "stop-color", "stroke", "bgcolor", "color"], vn = pn.map((function (e) { return "[".concat(e, "]") })).join(", "); function mn() { return fn.map((function (e) { var t = e.dataAttr, n = e.customProp, r = e.cssProp; return ["[".concat(t, "] {"), "  ".concat(r, ": var(").concat(n, ") !important;"), "}"].join("\n") })).join("\n") } var gn = new Map, yn = new Map; function bn(e, t, n) { gn.has(e) && (gn.get(e).disconnect(), yn.get(e).disconnect()); var r = new WeakSet; function o(e) { (function (e) { var t = []; return e instanceof Element && e.matches(vn) && t.push(e), (e instanceof Element || y && e instanceof ShadowRoot || e instanceof Document) && j(t, e.querySelectorAll(vn)), t })(e).forEach((function (e) { r.has(e) || (r.add(e), t(e)) })), G(e, (function (o) { r.has(e) || (r.add(e), n(o.shadowRoot), bn(o.shadowRoot, t, n)) })) } var a = re(e, { onMinorMutations: function (e) { e.additions.forEach((function (e) { return o(e) })) }, onHugeMutations: function () { o(e) } }); gn.set(e, a); var c = 0, s = null, l = q({ seconds: 10 }), d = q({ seconds: 2 }), f = [], h = null, p = B((function (e) { e.forEach((function (e) { pn.includes(e.attributeName) && t(e.target) })) })), v = new MutationObserver((function (e) { if (h) f.push.apply(f, u([], i(e), !1)); else { c++; var t = Date.now(); if (null == s) s = t; else if (c >= 50) { if (t - s < l) return h = setTimeout((function () { s = null, c = 0, h = null; var e = f; f = [], p(e) }), d), void f.push.apply(f, u([], i(e), !1)); s = t, c = 1 } p(e) } })); v.observe(e, { attributes: !0, attributeFilter: pn.concat(fn.map((function (e) { return e.dataAttr }))), subtree: !0 }), yn.set(e, v) } var kn = new WeakMap, Sn = ["brightness", "contrast", "grayscale", "sepia", "mode"]; function wn(e, t) { return pn.map((function (t) { return "".concat(t, '="').concat(e.getAttribute(t), '"') })).concat(Sn.map((function (e) { return "".concat(e, '="').concat(t[e], '"') }))).join(" ") } function En(e, t, n, r) { if (t.excludes) try { if (e.closest(t.excludes)) return } catch (e) { return console.error(e) } if (wn(e, t) !== kn.get(e)) { var o = new Set(Object.keys(dn)); if (n.length > 0 && function (e, t) { for (var n = 0, r = t.length; n < r; n++) { var o = t[n]; if (e.matches(o)) return !0 } return !1 }(e, n)) o.forEach((function (t) { e.removeAttribute(dn[t].dataAttr) })); else { if (e.hasAttribute("bgcolor")) ((u = e.getAttribute("bgcolor")).match(/^[0-9a-f]{3}$/i) || u.match(/^[0-9a-f]{6}$/i)) && (u = "#".concat(u)), c("background-color", "background-color", u); if (e.hasAttribute("color") && "mask-icon" !== e.rel) ((u = e.getAttribute("color")).match(/^[0-9a-f]{3}$/i) || u.match(/^[0-9a-f]{6}$/i)) && (u = "#".concat(u)), c("color", "color", u); if (e instanceof SVGElement) { if (e.hasAttribute("fill")) { var a = e.getAttribute("fill"); if ("none" !== a) if (e instanceof SVGTextElement) c("fill", "color", a); else { var i = function () { var t = e.getBoundingClientRect(), n = t.width, r = t.height; c("fill", n > 32 || r > 32 ? "background-color" : "color", a) }; K() ? i() : X(i) } } e.hasAttribute("stop-color") && c("stop-color", "background-color", e.getAttribute("stop-color")) } if (e.hasAttribute("stroke")) { var u = e.getAttribute("stroke"); c("stroke", e instanceof SVGLineElement || e instanceof SVGTextElement ? "border-color" : "color", u) } e.style && de(e.style, (function (t, n) { if ("background-image" !== t || !n.includes("url")) if (dn.hasOwnProperty(t) || t.startsWith("--") && !hn[t]) c(t, t, n); else { var r = hn[t]; if (r && !e.style.getPropertyValue(r) && !e.hasAttribute(r)) { if ("background-color" === r && e.hasAttribute("bgcolor")) return; e.style.setProperty(t, "") } } })), e.style && e instanceof SVGTextElement && e.style.fill && c("fill", "color", e.style.getPropertyValue("fill")), F(o, (function (t) { e.removeAttribute(dn[t].dataAttr) })), kn.set(e, wn(e, t)) } } function c(n, a, i) { var u = n.startsWith("--"), c = u ? {} : dn[n], s = c.customProp, l = c.dataAttr, d = Pt(a, i, { style: e.style }, Ht, r, null); if (d) { var f = d.value; if ("function" == typeof f && (f = f(t)), u && "object" == typeof f) f.declarations.forEach((function (t) { var n = t.property, r = t.value; !(r instanceof Promise) && e.style.setProperty(n, r) })); else e.style.setProperty(s, f), e.hasAttribute(l) || e.setAttribute(l, ""), o.delete(n) } } } var Cn = "theme-color", xn = 'meta[name="'.concat(Cn, '"]'), Tn = null, _n = null; function Vn(e, t) { var n = xe(Tn = Tn || e.content); n && (e.content = ot(n, t)) } var Rn = ["mode", "brightness", "contrast", "grayscale", "sepia", "darkSchemeBackgroundColor", "darkSchemeTextColor", "lightSchemeBackgroundColor", "lightSchemeTextColor"]; var An = function () { var e = [], t = null; function n() { for (var n; n = e.shift();)n(); t = null } return { add: function (r) { e.push(r), t || (t = requestAnimationFrame(n)) }, cancel: function () { e.splice(0), cancelAnimationFrame(t), t = null } } }(); function Mn() { var e = 0, t = new Set, n = new Map, r = new Set, o = null, a = !1, c = !1; return { modifySheet: function (s) { var l = s.sourceCSSRules, d = s.theme, f = s.ignoreImageAnalysis, h = s.force, p = s.prepareSheet, v = s.isAsyncCancelled, m = 0 === n.size, g = new Set(n.keys()), y = function (e) { var t = ""; return Rn.forEach((function (n) { t += "".concat(n, ":").concat(e[n], ";") })), t }(d), b = y !== o; a && (c = !0); var k = []; if (ce(l, (function (e) { var r = e.cssText, o = !1; if (g.delete(r), e.parentRule instanceof CSSMediaRule && (r += ";".concat(e.parentRule.media.mediaText)), t.has(r) || (t.add(r), o = !0), o) { m = !0; var a = []; e.style && de(e.style, (function (t, n) { var r = Pt(t, n, e, Ht, f, v); r && a.push(r) })); var i = null; if (a.length > 0) { var u = e.parentRule; i = { selector: e.selectorText, declarations: a, parentRule: u }, k.push(i) } n.set(r, i) } else k.push(n.get(r)) }), (function () { a = !0 })), g.forEach((function (e) { t.delete(e), n.delete(e) })), o = y, h || m || b) { e++; var S = new Map, w = new Map, E = 0, C = 0, x = { rule: null, rules: [], isGroup: !0 }, T = new WeakMap; r.forEach((function (e) { return e() })), r.clear(), k.filter((function (e) { return e })).forEach((function (t) { var n = t.selector, o = t.declarations, a = R(t.parentRule), c = { selector: n, declarations: [], isGroup: !1 }, s = c.declarations; function l(t, n, r, o) { var a = ++E, i = { property: t, value: null, important: r, asyncKey: a, sourceValue: o }; s.push(i); var u = e; n.then((function (t) { t && !v() && u === e && (i.value = t, An.add((function () { v() || u !== e || function (e) { var t = S.get(e), n = t.rule, r = t.target, o = t.index; r.deleteRule(o), V(r, o, n), S.delete(e) }(a) }))) })) } function f(t, n, o, a) { var c = n, d = c.declarations, f = c.onTypeChange, h = ++C, p = e, m = s.length, g = []; if (0 === d.length) { var y = { property: t, value: a, important: o, sourceValue: a, varKey: h }; s.push(y), g = [y] } d.forEach((function (e) { if (e.value instanceof Promise) l(e.property, e.value, o, a); else { var t = { property: e.property, value: e.value, important: o, sourceValue: a, varKey: h }; s.push(t), g.push(t) } })), f.addListener((function (t) { if (!v() && p === e) { var n = t.map((function (e) { return { property: e.property, value: e.value, important: o, sourceValue: a, varKey: h } })), r = s.indexOf(g[0], m); s.splice.apply(s, u([r, g.length], i(n), !1)), g = n, function (e) { var t = w.get(e), n = t.rule, r = t.target, o = t.index; r.deleteRule(o), V(r, o, n) }(h) } })), r.add((function () { return f.removeListeners() })) } a.rules.push(c), o.forEach((function (e) { var t = e.property, n = e.value, r = e.important, o = e.sourceValue; if ("function" == typeof n) { var a = n(d); a instanceof Promise ? l(t, a, r, o) : t.startsWith("--") ? f(t, a, r, o) : s.push({ property: t, value: a, important: r, sourceValue: o }) } else s.push({ property: t, value: n, important: r, sourceValue: o }) })) })); var _ = p(); !function e(t, n, r) { t.rules.forEach((function (t) { if (t.isGroup) { var o = function (e, t) { var n = e.rule; if (n instanceof CSSMediaRule) { var r = n.media, o = t.cssRules.length; return t.insertRule("@media ".concat(r.mediaText, " {}"), o), t.cssRules[o] } return t }(t, n); e(t, o, r) } else r(t, n) })) }(x, _, (function (e, t) { var n = t.cssRules.length; e.declarations.forEach((function (r) { var o = r.asyncKey, a = r.varKey; null != o && S.set(o, { rule: e, target: t, index: n }), null != a && w.set(a, { rule: e, target: t, index: n }) })), V(t, n, e) })) } function V(e, t, n) { function r(n, r) { const o = `${n} { ${r} }`; e.insertRule ? e.insertRule(o, t) : e.addRule && e.addRule(n, r, t) } try { const { selector: e, declarations: t } = n; if (!e || !t) throw new Error("Invalid rule"); if (d && d.excludes) { const t = d.excludes.replace(".", "").replace("#", ""), n = new RegExp(t, "g"); if (e.match(n)) return r(".dusky-ignore-class", ""); const o = document.querySelector(e); if (o && o.closest(d.excludes)) return } return r(e, t.map((e => { const t = e.property, n = e.value, r = e.important, o = e.sourceValue; return `${t}: ${null == n ? o : n}${r ? " !important" : ""};` })).join(" ")) } catch (e) { console.error(e) } } function R(e) { if (null == e) return x; if (T.has(e)) return T.get(e); var t = { rule: e, rules: [], isGroup: !0 }; return T.set(e, t), R(e.parentRule).rules.push(t), t } }, shouldRebuildStyle: function () { return a && !c } } } var Ln = 'style, link[rel*="stylesheet" i]:not([disabled])'; function On(e) { return (e instanceof HTMLStyleElement || e instanceof SVGStyleElement || e instanceof HTMLLinkElement && e.rel && e.rel.toLowerCase().includes("stylesheet") && e.href && !e.disabled && (!h || !e.href.startsWith("moz-extension://"))) && !e.classList.contains("dusky-dark") && "print" !== e.media.toLowerCase() && !e.classList.contains("stylus") } function Pn(e, t, n) { return void 0 === t && (t = []), void 0 === n && (n = !0), On(e) ? t.push(e) : (e instanceof Element || y && e instanceof ShadowRoot || e === document) && (F(e.querySelectorAll(Ln), (function (e) { return Pn(e, t, !1) })), n && G(e, (function (e) { return Pn(e.shadowRoot, t, !1) }))), t } var Dn = new WeakSet, In = new WeakSet, Nn = !1; document.addEventListener("__duskydark__inlineScriptsAllowed", (function () { Nn = !0 })); var Fn = 0, jn = new Map; function Bn(e, t) { for (var n = t.update, a = t.loadingStart, u = t.loadingEnd, c = [], s = e; (s = s.nextElementSibling) && s.matches(".dusky-dark");)c.push(s); var l = c.find((function (e) { return e.matches(".dusky-dark--cors") && !In.has(e) })) || null, d = c.find((function (e) { return e.matches(".dusky-dark--sync") && !Dn.has(e) })) || null, f = null, h = null, v = !1, m = !0, g = Mn(), y = new MutationObserver((function () { n() })), b = { attributes: !0, childList: !0, subtree: !0, characterData: !0 }; function k() { return e instanceof HTMLStyleElement && e.textContent.trim().match(he) } function S(e, t) { var n = !1; if (e) { var r = void 0; e: for (var o = 0, a = e.length; o < a; o++)if ((r = e[o]).href) { if (!t) { n = !0; break e } if (r.href.startsWith("http") && !r.href.startsWith(location.origin)) { n = !0; break e } } } return n } function w() { if (l) return l.sheet.cssRules; if (k()) return null; var t = A(); return e instanceof HTMLLinkElement && !function (e) { if (e.startsWith("data:")) return !0; var t = ie(e); return t.protocol === location.protocol && t.hostname === location.hostname && t.port === location.port && t.pathname === location.pathname }(e.href) && S(t, !1) || S(t, !0) ? null : t } function E() { l ? (e.nextSibling !== l && e.parentNode.insertBefore(l, e.nextSibling), l.nextSibling !== d && e.parentNode.insertBefore(d, l.nextSibling)) : e.nextSibling !== d && e.parentNode.insertBefore(d, e.nextSibling) } var C = !1, x = !1, T = ++Fn; function _() { return r(this, void 0, void 0, (function () { var t, n, r, a, u, c, s; return o(this, (function (o) { switch (o.label) { case 0: if (!(e instanceof HTMLLinkElement)) return [3, 7]; if (r = i(R(), 2), a = r[0], u = r[1], !(!a && !u && !p || p && !e.sheet || (d = u, d && d.message && d.message.includes("loading")))) return [3, 5]; o.label = 1; case 1: return o.trys.push([1, 3, , 4]), [4, qn(e, T)]; case 2: return o.sent(), [3, 4]; case 3: return o.sent(), x = !0, [3, 4]; case 4: if (v) return [2, null]; s = i(R(), 2), a = s[0], u = s[1], o.label = 5; case 5: return a && !S(a, !1) ? [2, a] : [4, Un(e.href)]; case 6: return t = o.sent(), n = ve(e.href), v ? [2, null] : [3, 8]; case 7: if (!k()) return [2, null]; t = e.textContent.trim(), n = ve(location.href), o.label = 8; case 8: if (!t) return [3, 13]; o.label = 9; case 9: return o.trys.push([9, 11, , 12]), [4, Wn(t, n)]; case 10: return c = o.sent(), l = function (e, t) { if (!t) return null; var n = document.createElement("style"); return n.classList.add("dusky-dark"), n.classList.add("dusky-dark--cors"), n.media = "screen", n.textContent = t, e.parentNode.insertBefore(n, e.nextSibling), n.sheet.disabled = !0, In.add(n), n }(e, c), [3, 12]; case 11: return o.sent(), [3, 12]; case 12: if (l) return f = W(l, "prev-sibling"), [2, l.sheet.cssRules]; o.label = 13; case 13: return [2, null] }var d })) })) } var V = !1; function R() { try { return null == e.sheet ? [null, null] : [e.sheet.cssRules, null] } catch (e) { return [null, e] } } function A() { var e = i(R(), 2), t = e[0]; return e[1] ? null : t } function M() { e.addEventListener("__duskydark__updateSheet", N), Nn && e.sheet || function () { L = P(), D(); var t = function () { P() !== L && (L = P(), n()), Nn && e.sheet ? D() : O = requestAnimationFrame(t) }; t() }() } var L = null, O = null; function P() { var e = A(); return e ? e.length : null } function D() { cancelAnimationFrame(O) } var I = !1; function N() { function e() { I = !1, v || n() } Nn = !0, D(), I || (I = !0, "function" == typeof queueMicrotask ? queueMicrotask(e) : requestAnimationFrame(e)) } function F() { e.removeEventListener("__duskydark__updateSheet", N), D() } function j() { y.disconnect(), v = !0, f && f.stop(), h && h.stop(), F() } var B = 0; return { details: function (e) { var t = w(); return t ? { rules: t } : (e.secondRound || C || x || (C = !0, a(), _().then((function (e) { C = !1, u(), e && n() })).catch((function (e) { C = !1, u() }))), null) }, render: function (t, r) { var o = w(); function a() { return d || ((d = e instanceof SVGStyleElement ? document.createElementNS("http://www.w3.org/2000/svg", "style") : document.createElement("style")).classList.add("dusky-dark"), d.classList.add("dusky-dark--sync"), d.media = "screen", e.title && (d.title = e.title), Dn.add(d)), h && h.stop(), E(), null == d.sheet && (d.textContent = ""), function (e) { for (var t = e.cssRules.length - 1; t >= 0; t--)e.deleteRule(t) }(d.sheet), h ? h.run() : h = W(d, "prev-sibling", (function () { V = !0, i() })), d.sheet } function i() { var e = V; V = !1, g.modifySheet({ prepareSheet: a, sourceCSSRules: o, theme: t, ignoreImageAnalysis: r, force: e, isAsyncCancelled: function () { return v } }), m = 0 === d.sheet.cssRules.length, g.shouldRebuildStyle() && X((function () { return n() })) } o && (v = !1, i()) }, pause: j, destroy: function () { if (j(), U(l), U(d), u(), jn.has(T)) { var e = jn.get(T); jn.delete(T), e && e() } }, watch: function () { y.observe(e, b), e instanceof HTMLStyleElement && M() }, restore: function () { d && (++B > 10 || (E(), f && f.skip(), h && h.skip(), m || (V = !0, n()))) } } } function qn(e, t) { return r(this, void 0, void 0, (function () { return o(this, (function (n) { return [2, new Promise((function (n, r) { var o = function () { e.removeEventListener("load", a), e.removeEventListener("error", i), jn.delete(t) }, a = function () { o(), n() }, i = function () { o(), r("Linkelement ".concat(t, " couldn't be loaded. ").concat(e.href)) }; jn.set(t, (function () { o(), r() })), e.addEventListener("load", a), e.addEventListener("error", i), e.href || i() }))] })) })) } function Un(e) { return r(this, void 0, void 0, (function () { return o(this, (function (t) { switch (t.label) { case 0: return e.startsWith("data:") ? [4, fetch(e)] : [3, 3]; case 1: return [4, t.sent().text()]; case 2: case 4: return [2, t.sent()]; case 3: return [4, gt({ url: e, responseType: "text", mimeType: "text/css", origin: window.location.origin })] } })) })) } function Wn(e, t, n) { return void 0 === n && (n = new Map), r(this, void 0, void 0, (function () { var r, i, u, c, s, l, d, f, h, p; return o(this, (function (o) { switch (o.label) { case 0: e = function (e, t) { return e.replace(fe, (function (e) { var n = pe(e); try { return "url('".concat(ue(t, n), "')") } catch (t) { return e } })) }(e = function (e) { return e.replace(ge, "") }(e = e.replace(me, "")), t), r = Se(he, e), o.label = 1; case 1: o.trys.push([1, 10, 11, 12]), i = a(r), u = i.next(), o.label = 2; case 2: return u.done ? [3, 9] : (c = u.value, s = pe(c.substring(7).trim().replace(/;$/, "").replace(/screen$/, "")), l = ue(t, s), d = void 0, n.has(l) ? (d = n.get(l), [3, 7]) : [3, 3]); case 3: return o.trys.push([3, 6, , 7]), [4, Un(l)]; case 4: return d = o.sent(), n.set(l, d), [4, Wn(d, ve(l), n)]; case 5: return d = o.sent(), [3, 7]; case 6: return o.sent(), d = "", [3, 7]; case 7: e = e.split(c).join(d), o.label = 8; case 8: return u = i.next(), [3, 2]; case 9: return [3, 12]; case 10: return f = o.sent(), h = { error: f }, [3, 12]; case 11: try { u && !u.done && (p = i.return) && p.call(i) } finally { if (h) throw h.error } return [7]; case 12: return [2, e = e.trim()] } })) })) } var Gn, Hn, $n = [], zn = new Map; function Qn(e) { k && F(e.querySelectorAll(":not(:defined)"), (function (e) { var t = e.tagName.toLowerCase(); if (!t.includes("-")) { var n = e.getAttribute("is"); if (!n) return; t = n } zn.has(t) || (zn.set(t, new Set), function (e) { return r(this, void 0, void 0, (function () { return o(this, (function (t) { return [2, new Promise((function (t) { if (window.customElements && "function" == typeof customElements.whenDefined) customElements.whenDefined(e).then((function () { return t() })); else if (Kn) Yn.set(e, t), document.dispatchEvent(new CustomEvent("__duskydark__addUndefinedResolver", { detail: { tag: e } })); else { var n = function () { var r = zn.get(e); r && r.size > 0 && (r.values().next().value.matches(":defined") ? t() : requestAnimationFrame(n)) }; requestAnimationFrame(n) } }))] })) })) }(t).then((function () { if (Hn) { var e = zn.get(t); zn.delete(t), Hn(Array.from(e)) } }))), zn.get(t).add(e) })) } var Kn = !1; document.addEventListener("__duskydark__inlineScriptsAllowed", (function () { Kn = !0 })); var Yn = new Map; function Xn(e) { (Kn = !0, Yn.has(e.detail.tag)) && Yn.get(e.detail.tag)() } function Zn(e, t, n) { Jn(); var r = new Set(e), o = new WeakMap, a = new WeakMap; function i(e) { o.set(e, e.previousElementSibling), a.set(e, e.nextElementSibling) } function u(e) { var n = e.createdStyles, u = e.removedStyles, c = e.movedStyles; n.forEach((function (e) { return i(e) })), c.forEach((function (e) { return i(e) })), u.forEach((function (e) { return t = e, o.delete(t), void a.delete(t); var t })), n.forEach((function (e) { return r.add(e) })), u.forEach((function (e) { return r.delete(e) })), n.size + u.size + c.size > 0 && t({ created: Array.from(n), removed: Array.from(u), moved: Array.from(c), updated: [] }) } function c(e) { var t = e.additions, n = e.moves, r = e.deletions, o = new Set, a = new Set, i = new Set; t.forEach((function (e) { return Pn(e).forEach((function (e) { return o.add(e) })) })), r.forEach((function (e) { return Pn(e).forEach((function (e) { return a.add(e) })) })), n.forEach((function (e) { return Pn(e).forEach((function (e) { return i.add(e) })) })), u({ createdStyles: o, removedStyles: a, movedStyles: i }), t.forEach((function (e) { G(e, f), Qn(e) })) } function s(e) { var t = new Set(Pn(e)), n = new Set, i = new Set, c = new Set; t.forEach((function (e) { r.has(e) || n.add(e) })), r.forEach((function (e) { t.has(e) || i.add(e) })), t.forEach((function (e) { var t; n.has(e) || i.has(e) || (t = e).previousElementSibling === o.get(t) && t.nextElementSibling === a.get(t) || c.add(e) })), u({ createdStyles: n, removedStyles: i, movedStyles: c }), G(e, f), Qn(e) } function l(e) { var n = new Set, r = new Set; e.forEach((function (e) { var t = e.target; t.isConnected && (On(t) ? n.add(t) : t instanceof HTMLLinkElement && t.disabled && r.add(t)) })), n.size + r.size > 0 && t({ updated: Array.from(n), created: [], removed: Array.from(r), moved: [] }) } function d(e) { var t = re(e, { onMinorMutations: c, onHugeMutations: s }), n = new MutationObserver(l); n.observe(e, { attributes: !0, attributeFilter: ["rel", "disabled", "media", "href"], subtree: !0 }), $n.push(t, n), Gn.add(e) } function f(e) { var t = e.shadowRoot; null == t || Gn.has(t) || (d(t), n(t)) } e.forEach(i), d(document), G(document.documentElement, f), Hn = function (e) { var n = []; e.forEach((function (e) { return j(n, Pn(e.shadowRoot)) })), t({ created: n, updated: [], removed: [], moved: [] }), e.forEach((function (e) { var t = e.shadowRoot; null != t && (f(e), G(t, f), Qn(t)) })) }, document.addEventListener("__duskydark__isDefined", Xn), Qn(document) } function Jn() { $n.forEach((function (e) { return e.disconnect() })), $n.splice(0, $n.length), Gn = new WeakSet, Hn = null, zn.clear(), document.removeEventListener("__duskydark__isDefined", Xn) } var er = new WeakMap, tr = new WeakSet; function nr(e) { var t = !1; return { render: function (n, r) { e.adoptedStyleSheets.forEach((function (o) { if (!tr.has(o)) { var a = o.rules, c = new CSSStyleSheet; Mn().modifySheet({ prepareSheet: function () { for (var t = c.cssRules.length - 1; t >= 0; t--)c.deleteRule(t); return function (t, n) { var r = u([], i(e.adoptedStyleSheets), !1), o = r.indexOf(t), a = r.indexOf(n); o !== a - 1 && (a >= 0 && r.splice(a, 1), r.splice(o + 1, 0, n), e.adoptedStyleSheets = r) }(o, c), er.set(o, c), tr.add(c), c }, sourceCSSRules: a, theme: n, ignoreImageAnalysis: r, force: !1, isAsyncCancelled: function () { return t } }) } })) }, destroy: function () { t = !0; var n = u([], i(e.adoptedStyleSheets), !1); e.adoptedStyleSheets.forEach((function (e) { if (tr.has(e)) { var t = n.indexOf(e); t >= 0 && n.splice(t, 1), er.delete(e), tr.delete(e) } })), e.adoptedStyleSheets = n } } } function rr(e) { document.dispatchEvent(new CustomEvent("__duskydark__inlineScriptsAllowed")); var t = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, "addRule"), n = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, "insertRule"), r = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, "deleteRule"), o = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, "removeRule"), a = e ? Object.getOwnPropertyDescriptor(Document.prototype, "styleSheets") : null, c = ["baidu.com", "baike.baidu.com", "ditu.baidu.com", "map.baidu.com", "maps.baidu.com", "haokan.baidu.com", "pan.baidu.com", "passport.baidu.com", "tieba.baidu.com", "www.baidu.com"].includes(location.hostname), s = c ? Object.getOwnPropertyDescriptor(Element.prototype, "getElementsByTagName") : null, l = function () { Object.defineProperty(CSSStyleSheet.prototype, "addRule", t), Object.defineProperty(CSSStyleSheet.prototype, "insertRule", n), Object.defineProperty(CSSStyleSheet.prototype, "deleteRule", r), Object.defineProperty(CSSStyleSheet.prototype, "removeRule", o), document.removeEventListener("__duskydark__cleanUp", l), document.removeEventListener("__duskydark__addUndefinedResolver", d), e && Object.defineProperty(Document.prototype, "styleSheets", a), c && Object.defineProperty(Element.prototype, "getElementsByTagName", s) }, d = function (e) { customElements.whenDefined(e.detail.tag).then((function () { document.dispatchEvent(new CustomEvent("__duskydark__isDefined", { detail: { tag: e.detail.tag } })) })) }; document.addEventListener("__duskydark__cleanUp", l), document.addEventListener("__duskydark__addUndefinedResolver", d); var f = new Event("__duskydark__updateSheet"); Object.defineProperty(CSSStyleSheet.prototype, "addRule", Object.assign({}, t, { value: function (e, n, r) { return t.value.call(this, e, n, r), this.ownerNode && !this.ownerNode.classList.contains("dusky-dark") && this.ownerNode.dispatchEvent(f), -1 } })), Object.defineProperty(CSSStyleSheet.prototype, "insertRule", Object.assign({}, n, { value: function (e, t) { var r = n.value.call(this, e, t); return this.ownerNode && !this.ownerNode.classList.contains("dusky-dark") && this.ownerNode.dispatchEvent(f), r } })), Object.defineProperty(CSSStyleSheet.prototype, "deleteRule", Object.assign({}, r, { value: function (e) { r.value.call(this, e), this.ownerNode && !this.ownerNode.classList.contains("dusky-dark") && this.ownerNode.dispatchEvent(f) } })), Object.defineProperty(CSSStyleSheet.prototype, "removeRule", Object.assign({}, o, { value: function (e) { o.value.call(this, e), this.ownerNode && !this.ownerNode.classList.contains("dusky-dark") && this.ownerNode.dispatchEvent(f) } })), e && Object.defineProperty(Document.prototype, "styleSheets", Object.assign({}, a, { get: function () { var e = this, t = function () { var t = u([], i(a.get.call(e)), !1).filter((function (e) { return !e.ownerNode.classList.contains("dusky-dark") })); return t.item = function (e) { return t[e] }, Object.setPrototypeOf(t, StyleSheetList.prototype) }, n = t(); return new Proxy(n, { get: function (e, n) { return t()[n] } }) } })), c && Object.defineProperty(Element.prototype, "getElementsByTagName", Object.assign({}, s, { value: function (e) { var t = this; if ("style" !== e) return s.value.call(this, e); var n = function () { var n = s.value.call(t, e); return Object.setPrototypeOf(u([], i(n), !1).filter((function (e) { return !e.classList.contains("dusky-dark") })), NodeList.prototype) }, r = n(); return new Proxy(r, { get: function (e, t) { return n()[Number(t) || t] } }) } })) } var or = function () { if ("randomUUID" in crypto) { var e = crypto.randomUUID(); return e.substring(0, 8) + e.substring(9, 13) + e.substring(14, 18) + e.substring(19, 23) + e.substring(24) } return Array.from(crypto.getRandomValues(new Uint8Array(16))).map((function (e) { return ((t = e) < 16 ? "0" : "") + t.toString(16); var t })).join("") }(), ar = new Map, ir = [], ur = null, cr = null, sr = null, lr = null, dr = null; function fr(e, t) { void 0 === t && (t = document.head || document); var n = t.querySelector(".".concat(e)); return n || ((n = document.createElement("style")).classList.add("dusky-dark"), n.classList.add(e), n.media = "screen", n.textContent = ""), n } var hr = new Map; function pr(e, t) { hr.has(t) && hr.get(t).stop(), hr.set(t, W(e, "parent")) } function vr() { var e = fr("dusky-dark--fallback", document); e.textContent = Ft(ur, { strict: !0 }), document.head.insertBefore(e, document.head.firstChild), pr(e, "fallback"); var t = fr("dusky-dark--user-agent"); t.textContent = It(ur, sr, ur.styleSystemControls), document.head.insertBefore(t, e.nextSibling), pr(t, "user-agent"); var r, o, a = fr("dusky-dark--text"); ur.useFont || ur.textStroke > 0 ? a.textContent = (r = ur, (o = []).push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*="vjs-"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*="mu-"], .glyphicon, .icon, .dusky-ignore *) {'), r.useFont && r.fontFamily && o.push("  font-family: ".concat(r.fontFamily, " !important;")), r.textStroke > 0 && (o.push("  -webkit-text-stroke: ".concat(r.textStroke, "px !important;")), o.push("  text-stroke: ".concat(r.textStroke, "px !important;"))), o.push("}"), o.join("\n")) : a.textContent = "", document.head.insertBefore(a, e.nextSibling), pr(a, "text"); var i = fr("dusky-dark--invert"); cr && Array.isArray(cr.invert) && cr.invert.length > 0 ? i.textContent = ["".concat(cr.invert.join(", "), " {"), "    filter: ".concat(ht(n(n({}, ur), { contrast: 0 === ur.mode ? ur.contrast : We(ur.contrast - 10, 0, 100) })), " !important;"), "}"].join("\n") : i.textContent = "", document.head.insertBefore(i, a.nextSibling), pr(i, "invert"); var u = fr("dusky-dark--inline"); u.textContent = mn(), document.head.insertBefore(u, i.nextSibling), pr(u, "inline"); var c = fr("dusky-dark--override"); c.textContent = cr && cr.css ? yr(cr.css) : "", document.head.appendChild(c), pr(c, "override"); var s = fr("dusky-dark--variables"), l = Nt(ur), d = ur.darkSchemeBackgroundColor, f = ur.darkSchemeTextColor, h = ur.lightSchemeBackgroundColor, p = ur.lightSchemeTextColor, v = ur.mode, m = 0 === v ? h : d, g = 0 === v ? p : f; m = ot(xe(m), ur), g = st(xe(g), ur), s.textContent = [":root {", "   --dusky-dark-mode-neutral-background: ".concat(m, ";"), "   --dusky-dark-mode-neutral-text: ".concat(g, ";"), "   --dusky-dark-mode-selection-background: ".concat(l.backgroundColorSelection, ";"), "   --dusky-dark-mode-selection-text: ".concat(l.foregroundColorSelection, ";"), "}"].join("\n"), document.head.insertBefore(s, u.nextSibling), pr(s, "variables"); var y = fr("dusky-dark--root-vars"); document.head.insertBefore(y, s.nextSibling); var b = !(cr && cr.disableStyleSheetsProxy), k = function (e, t) { void 0 === t && (t = document.head || document); var n = t.querySelector(".".concat(e)); return n || ((n = document.createElement("script")).classList.add("dusky-dark"), n.classList.add(e)), n }("dusky-dark--proxy"); k.append("(".concat(rr, ")(").concat(b, ")")), document.head.insertBefore(k, y.nextSibling), k.remove() } var mr = new Set; function gr(e) { var t = fr("dusky-dark--inline", e); t.textContent = mn(), e.insertBefore(t, e.firstChild); var r = fr("dusky-dark--override", e); r.textContent = cr && cr.css ? yr(cr.css) : "", e.insertBefore(r, t.nextSibling); var o = fr("dusky-dark--invert", e); cr && Array.isArray(cr.invert) && cr.invert.length > 0 ? o.textContent = ["".concat(cr.invert.join(", "), " {"), "    filter: ".concat(ht(n(n({}, ur), { contrast: 0 === ur.mode ? ur.contrast : We(ur.contrast - 10, 0, 100) })), " !important;"), "}"].join("\n") : o.textContent = "", e.insertBefore(o, r.nextSibling), mr.add(e) } function yr(e) { return e.replace(/\${(.+?)}/g, (function (e, t) { var n = xe(t); return n ? Ze(n, ur, Je) : t })) } function br() { var e = document.querySelector(".dusky-dark--fallback"); e && (e.textContent = "") } var kr = 0, Sr = new Set; function wr(e) { var t = ++kr; var n = Bn(e, { update: function () { var e = n.details({ secondRound: !0 }); e && (Ht.addRulesForMatching(e.rules), Ht.matchVariablesAndDependants(), n.render(ur, lr)) }, loadingStart: function () { if (!H() || !Rr) { Sr.add(t), "Current amount of styles loading: ".concat(Sr.size); var e = document.querySelector(".dusky-dark--fallback"); e.textContent || (e.textContent = Ft(ur, { strict: !1 })) } }, loadingEnd: function () { Sr.delete(t), "Removed loadingStyle ".concat(t, ", now awaiting: ").concat(Sr.size), 0 === Sr.size && H() && br() } }); return ar.set(e, n), n } function Er(e) { var t = ar.get(e); t && (t.destroy(), ar.delete(e)) } var Cr = B((function (e) { ar.forEach((function (e) { return e.render(ur, lr) })), ir.forEach((function (e) { return e.render(ur, lr) })), e && e() })), xr = function () { Cr.cancel() }; function Tr() { 0 !== Sr.size || br() } var _r, Vr = null, Rr = !document.hidden; function Ar() { document.removeEventListener("visibilitychange", Vr), Vr = null } function Mr() { function e() { var e, t; !function () { xr(); var e = Pn(document).filter((function (e) { return !ar.has(e) })).map((function (e) { return wr(e) })); e.map((function (e) { return e.details({ secondRound: !1 }) })).filter((function (e) { return e && e.rules.length > 0 })).forEach((function (e) { Ht.addRulesForMatching(e.rules) })), Ht.matchVariablesAndDependants(), Ht.setOnRootVariableChange((function () { Ht.putRootVars(document.head.querySelector(".dusky-dark--root-vars"), ur) })), Ht.putRootVars(document.head.querySelector(".dusky-dark--root-vars"), ur), ar.forEach((function (e) { return e.render(ur, lr) })), 0 === Sr.size && br(), e.forEach((function (e) { return e.watch() })); var t = function (e) { for (var t = [], n = 0, r = e.length; n < r; n++)t.push(e[n]); return t }(document.querySelectorAll(vn)); G(document.documentElement, (function (e) { gr(e.shadowRoot); var n = e.shadowRoot.querySelectorAll(vn); n.length > 0 && j(t, n) })), t.forEach((function (e) { return En(e, ur, dr, lr) })), Lr(document) }(), Zn(Array.from(ar.keys()), (function (e) { var t = e.created, n = e.updated, r = e.removed, o = e.moved, a = r, i = t.concat(n).concat(o).filter((function (e) { return !ar.has(e) })), u = o.filter((function (e) { return ar.has(e) })); a.forEach((function (e) { return Er(e) })); var c = i.map((function (e) { return wr(e) })); c.map((function (e) { return e.details({ secondRound: !1 }) })).filter((function (e) { return e && e.rules.length > 0 })).forEach((function (e) { Ht.addRulesForMatching(e.rules) })), Ht.matchVariablesAndDependants(), c.forEach((function (e) { return e.render(ur, lr) })), c.forEach((function (e) { return e.watch() })), u.forEach((function (e) { return ar.get(e).restore() })) }), (function (e) { gr(e), Lr(e) })), e = function (e) { En(e, ur, dr, lr), e === document.documentElement && (e.getAttribute("style") || "").includes("--") && (Ht.matchVariablesAndDependants(), Ht.putRootVars(document.head.querySelector(".dusky-dark--root-vars"), ur)) }, t = function (e) { gr(e); var t = e.querySelectorAll(vn); t.length > 0 && F(t, (function (e) { return En(e, ur, dr, lr) })) }, bn(document, e, t), G(document.documentElement, (function (n) { bn(n.shadowRoot, e, t) })), z(Tr) } var t, n, r, o; vr(), document.hidden && !ur.immediateModify ? (t = e, n = Boolean(Vr), Vr = function () { document.hidden || (Ar(), t(), Rr = !0) }, n || document.addEventListener("visibilitychange", Vr)) : e(), r = ur, (o = document.querySelector(xn)) ? Vn(o, r) : (_n && _n.disconnect(), (_n = new MutationObserver((function (e) { e: for (var t = 0; t < e.length; t++)for (var n = e[t].addedNodes, o = 0; o < n.length; o++) { var a = n[o]; if (a instanceof HTMLMetaElement && a.name === Cn) { _n.disconnect(), _n = null, Vn(a, r); break e } } }))).observe(document.head, { childList: !0 })) } function Lr(e) { try { if (Array.isArray(e.adoptedStyleSheets) && e.adoptedStyleSheets.length > 0) { var t = nr(e); ir.push(t), t.render(ur, lr) } } catch (e) { } } function Or() { ar.forEach((function (e) { return e.pause() })), F(hr.values(), (function (e) { return e.stop() })), hr.clear(), Jn(), gn.forEach((function (e) { return e.disconnect() })), yn.forEach((function (e) { return e.disconnect() })), gn.clear(), yn.clear(), Q(Tr), Y.clear() } function Pr() { if (document.querySelector('meta[name="dusky-dark-lock"]')) return !0; var e, t = document.querySelector('meta[name="dusky-dark"]'); return t ? t.content !== or : ((e = document.createElement("meta")).name = "dusky-dark", e.content = or, document.head.appendChild(e), (_r = new MutationObserver((function () { document.querySelector('meta[name="dusky-dark-lock"]') && (_r.disconnect(), Ir()) }))).observe(document.head, { childList: !0, subtree: !0 }), !1) } function Dr(e, t, n) { if (ur = e, (cr = t) ? (lr = Array.isArray(cr.ignoreImageAnalysis) ? cr.ignoreImageAnalysis : [], dr = Array.isArray(cr.ignoreInlineStyle) ? cr.ignoreInlineStyle : []) : (lr = [], dr = []), ur.immediateModify && (H = function () { return !0 }), sr = n, document.head) { if (Pr()) return; document.documentElement.setAttribute("data-dusky-dark-mode", "dark"), Mr() } else { if (!h) { var r = fr("dusky-dark--fallback"); document.documentElement.appendChild(r), r.textContent = Ft(ur, { strict: !0 }) } var o = new MutationObserver((function () { if (document.head) { if (o.disconnect(), Pr()) return void Ir(); Mr() } })); o.observe(document, { childList: !0, subtree: !0 }) } } function Ir() { document.documentElement.removeAttribute("data-dusky-dark-mode"), document.documentElement.removeAttribute("data-dusky-dark-scheme"), Ht.clear(), oe.clear(), Ar(), xr(), Or(), Gt(), Ee.clear(), Ce.clear(), U(document.querySelector(".dusky-dark--fallback")), document.head && (!function () { _n && (_n.disconnect(), _n = null); var e = document.querySelector(xn); e && Tn && (e.content = Tn) }(), U(document.head.querySelector(".dusky-dark--user-agent")), U(document.head.querySelector(".dusky-dark--text")), U(document.head.querySelector(".dusky-dark--invert")), U(document.head.querySelector(".dusky-dark--inline")), U(document.head.querySelector(".dusky-dark--override")), U(document.head.querySelector(".dusky-dark--variables")), U(document.head.querySelector(".dusky-dark--root-vars")), U(document.head.querySelector('meta[name="dusky-dark"]')), document.dispatchEvent(new CustomEvent("__duskydark__cleanUp")), U(document.head.querySelector(".dusky-dark--proxy"))), mr.forEach((function (e) { U(e.querySelector(".dusky-dark--inline")), U(e.querySelector(".dusky-dark--override")) })), mr.clear(), F(ar.keys(), (function (e) { return Er(e) })), Sr.clear(), jn.clear(), F(document.querySelectorAll(".dusky-dark"), U), ir.forEach((function (e) { e.destroy() })), ir.splice(0), _r && _r.disconnect() } var Nr = /url\(\"(blob\:.*?)\"\)/g; function Fr(e) { return r(this, void 0, void 0, (function () { var t, n; return o(this, (function (r) { switch (r.label) { case 0: return t = [], Se(Nr, e, 1).forEach((function (e) { var n = E(e); t.push(n) })), [4, Promise.all(t)]; case 1: return n = r.sent(), [2, e.replace(Nr, (function () { return 'url("'.concat(n.shift(), '")') }))] } })) })) } var jr = "Dusky Dark"; function Br() { return r(this, void 0, void 0, (function () { function e(e, n) { var r = document.querySelector(e); r && r.textContent && (t.push("/* ".concat(n, " */")), t.push(r.textContent), t.push("")) } var t, n, r, a, i; return o(this, (function (o) { switch (o.label) { case 0: return t = [jr], e(".dusky-dark--fallback", "Fallback Style"), e(".dusky-dark--user-agent", "User-Agent Style"), e(".dusky-dark--text", "Text Style"), e(".dusky-dark--invert", "Invert Style"), e(".dusky-dark--variables", "Variables Style"), n = [], document.querySelectorAll(".dusky-dark--sync").forEach((function (e) { F(e.sheet.cssRules, (function (e) { e && e.cssText && n.push(e.cssText) })) })), n.length ? (r = function (e) { function t(e) { return e.replace(/^\s+/, "") } function n(e) { return 0 === e ? "" : " ".repeat(4 * e) } if (e.length < 5e4) for (var r = /[^{}]+{\s*}/; r.test(e);)e = e.replace(r, ""); for (var o = e.replace(/\s{2,}/g, " ").replace(/\{/g, "{\n").replace(/\}/g, "\n}\n").replace(/\;(?![^\(|\"]*(\)|\"))/g, ";\n").replace(/\,(?![^\(|\"]*(\)|\"))/g, ",\n").replace(/\n\s*\n/g, "\n").split("\n"), a = 0, i = [], u = 0, c = o.length; u < c; u++) { var s = "".concat(o[u], "\n"); s.includes("{") ? i.push(n(a++) + t(s)) : s.includes("}") ? i.push(n(--a) + t(s)) : i.push(n(a) + t(s)) } return i.join("").trim() }(n.join("\n")), t.push("/* Modified CSS */"), i = (a = t).push, [4, Fr(r)]) : [3, 2]; case 1: i.apply(a, [o.sent()]), t.push(""), o.label = 2; case 2: return e(".dusky-dark--override", "Override Style"), [2, t.join("\n")] } })) })) } var qr = !1, Ur = function () { try { return window.self !== window.top } catch (e) { return console.warn(e), !0 } }(); function Wr(e, t) { document.dispatchEvent(new CustomEvent("dusky__enable")), void 0 === e && (e = {}), void 0 === t && (t = null); var r = n(n({}, N), e); if (r.engine !== V.dynamicTheme) throw new Error("Theme engine is not supported."); Dr(r, t, Ur), qr = !0 } function Gr() { document.dispatchEvent(new CustomEvent("dusky__disable")), Ir(), qr = !1 } var Hr = matchMedia("(prefers-color-scheme: dark)"), $r = { themeOptions: null, fixes: null }; function zr() { Hr.matches ? Wr($r.themeOptions, $r.fixes) : Gr() } var Qr = function (e) { T = e || x }; e.auto = function (e, t) { void 0 === e && (e = {}), void 0 === t && (t = null), e ? ($r = { themeOptions: e, fixes: t }, zr(), b ? Hr.addEventListener("change", zr) : Hr.addListener(zr)) : (b ? Hr.removeEventListener("change", zr) : Hr.removeListener(zr), Gr()) }, e.disable = Gr, e.enable = Wr, e.exportGeneratedCSS = function () { return r(this, void 0, void 0, (function () { return o(this, (function (e) { switch (e.label) { case 0: return [4, Br()]; case 1: return [2, e.sent()] } })) })) }, e.isEnabled = function () { return qr }, e.setFetchMethod = Qr, Object.defineProperty(e, "__esModule", { value: !0 }) }));